/*! website-blogs - v3.29.3 - 2020-03-17 */
define("leave-behind",["jquery"],function($){var LeaveBehind=function(options){this.init(options)};return LeaveBehind.prototype={init:function(options){this._options=options;var _this=this;Object.defineProperty(this,"options",{get:function(){return _this._options}});var $body=$(document.body);$(".leave-behind").length||$body.append('<div class="leave-behind"></div>')},setup:function(){var _this=this;$.when(this.loadTemplates(),this.loadBids()).done(function(tmpl,tmplData){_this.show(tmpl,tmplData)}).fail(function(){console.log("Fail",arguments)})},show:function(templateName,tmplData){var $body=$(document.body);$(".lightbox-overlay").length||$body.prepend('<div class="lightbox-overlay"></div>'),$body.addClass("lb-showing"),$(".leave-behind").show(),this.addListeners()},render:function(templateName,tmplData){$(".leave-behind").html($.templates[templateName].render(tmplData))},enable:function(cb){var $body=$(document.body);$(".lightbox-overlay").length||$body.prepend('<div class="lightbox-overlay"></div>'),$body.addClass("lb-showing");var $lb=$(".leave-behind");$lb.length&&($lb.on("close",$.proxy(this.closed,this,$lb)),$lb.on("click",".close",$.proxy(this.close,this,$lb)),$lb.on("click",".compare-button",cb),$lb.show())},close:function($lb){$lb.hide(),$(document.body).removeClass("lb-showing")},closed:function($lb){console.log("closed")},loadBids:function(){var rv=$.Deferred(),_this=this,work=function(){if(!_this.missingRequestParams(_this.options))return void rv.reject("validation");var data={originCityCode:_this.options.originCityCode,destinationCityCode:_this.options.destinationCityCode,departureDate:_this.options.departureDate,returnDate:_this.options.returnDate,ipAddress:_this.options.ipAddress,userAgent:window.navigator.userAgent,sessionId:_this.options.sessionId,userSearchId:_this.options.userSearchId,productType:_this.options.productType,placementType:_this.options.placementType,adblockDetected:_this.options.adblockDetected,roundTrip:_this.options.roundTrip,adults:_this.options.adults,children:_this.options.adults,infants:_this.options.infants,noOfRooms:_this.options.noOfRooms||1,geoLocation:_this.options.geoLocation,siteCode:_this.options.siteCode,iframeCompatible:_this.options.iframeCompatible,deviceType:_this.options.deviceType,resolution:_this.options.resolution};$.ajax({url:"/c2ads/getCompareToAdsVersion3.do",method:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(data)}).done(function(data){var bids=[];data.compareToAds.map(function(ad,index){index>5||bids.push({name:ad.displayName,value:"/12q/latest/external/trackC2?url="+encodeURIComponent(ad.clickToUrl),label:ad.imageUrl})});var tmplData={destCity:_this.options.destCity,travel:_this.options.travel,passengers:_this.options.adults+_this.options.children+_this.options.infants,rooms:_this.options.noOfRooms,guests:_this.options.adults,bids:bids};rv.resolve(tmplData)}).fail(rv.reject)};return setTimeout(work,0),rv},loadTemplates:function(){var rv=$.Deferred(),_this=this,work=function(){$.templates["leave-behind"]?rv.resolve("leave-behind"):$.get("/resources/v4/leave-behind/templates/frame-"+_this.options.language+"-v2.tmpl").done(function(tmplData){$.templates("leave-behind",tmplData),rv.resolve("leave-behind")}).fail(rv.reject)};return setTimeout(work,0),rv},missingRequestParams:function(options){return 3==options.originCityCode.length&&options.departureDate>0&&(!options.roundTrip||options.returnDate>0)&&options.placementType.length>0&&Number(options.adults)+Number(options.children||0)+Number(options.infants||0)>0&&("Hotel"==options.productType&&options.noOfRooms>0&&Number(options.destinationCityCode)>0||"Flights"==options.productType&&3==options.destinationCityCode.length)&&options.geoLocation.length>0&&options.siteCode>0&&options.deviceType.length>0&&options.destCity.length>0&&options.travel.length>0},setupScripts:function(){},setupCss:function(){}},LeaveBehind}),function(){for(var method,noop=function(){},methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)method=methods[length],console[method]||(console[method]=noop)}(),define("bootstrap",["jquery"],function(jQuery){if(void 0===jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})}var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.2.0",Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$(selector);e&&e.preventDefault(),$parent.length||($parent=$this.hasClass("alert")?$this:$this.parent()),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(150):removeElement())};var old=$.fn.alert;$.fn.alert=Plugin,$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||$this.data("bs.button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.2.0",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),$el[val](null==data[state]?this.options[state]:data[state]),setTimeout($.proxy(function(){"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")&&($input.prop("checked")&&this.$element.hasClass("active")?changed=!1:$parent.find(".active").removeClass("active")),changed&&$input.prop("checked",!this.$element.hasClass("active")).trigger("change")}changed&&this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var $btn=$(e.target);$btn.hasClass("btn")||($btn=$btn.closest(".btn")),Plugin.call($btn,"toggle"),e.preventDefault()})}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element).on("keydown.bs.carousel",$.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.2.0",Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},Carousel.prototype.keydown=function(e){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(pos>this.$items.length-1||pos<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",$(this.$items[pos]))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){if(!this.sliding)return this.slide("next")},Carousel.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||$active[type](),isCycling=this.interval,direction="next"==type?"left":"right",fallback="next"==type?"first":"last",that=this;if(!$next.length){if(!this.options.wrap)return;$next=this.$element.find(".item")[fallback]()}if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd(1e3*$active.css("transition-duration").slice(0,-1))):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this},$(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}}),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&"show"==option&&(option=!option),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.transitioning=null,this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};Collapse.VERSION="3.2.0",Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var actives=this.$parent&&this.$parent.find("> .panel > .in");if(actives&&actives.length){var hasData=actives.data("bs.collapse");if(hasData&&hasData.transitioning)return;Plugin.call(actives,"hide"),hasData||actives.data("bs.collapse",null)}var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(350)[dimension](this.$element[0][scrollSize])}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!$.support.transition)return complete.call(this);this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(350)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var href,$this=$(this),target=$this.attr("data-target")||e.preventDefault()||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),$target=$(target),data=$target.data("bs.collapse"),option=data?"toggle":$this.data(),parent=$this.attr("data-parent"),$parent=parent&&$(parent);data&&data.transitioning||($parent&&$parent.find('[data-toggle="collapse"][data-parent="'+parent+'"]').not($this).addClass("collapsed"),$this[$target.hasClass("in")?"addClass":"removeClass"]("collapsed")),Plugin.call($target,option)})}(jQuery),function($){"use strict";function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $parent=getParent($(this)),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget))}))}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.2.0",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus"),$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget)}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive||isActive&&27==e.keyCode)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.divider):visible a",$items=$parent.find('[role="menu"]'+desc+', [role="listbox"]'+desc);if($items.length){var index=$items.index($items.filter(":focus"));38==e.keyCode&&index>0&&index--,40==e.keyCode&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle+', [role="menu"], [role="listbox"]',Dropdown.prototype.keydown)}(jQuery),function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.2.0",Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$element.find(".modal-dialog").one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(300):that.$element.trigger("focus").trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(150):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(150):callbackRemove()}else callback&&callback()},Modal.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})}var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.2.0",Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$(this.options.viewport.selector||this.options.viewport);for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);if(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="in",!self.options.delay||!self.options.delay.show)return self.show();self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);if(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="out",!self.options.delay||!self.options.delay.hide)return self.hide();self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,$parent=this.$element.parent(),parentDim=this.getPosition($parent);placement="bottom"==placement&&pos.top+pos.height+actualHeight-parentDim.scroll>parentDim.height?"top":"top"==placement&&pos.top-parentDim.scroll-actualHeight<0?"bottom":"right"==placement&&pos.right+actualWidth>parentDim.width?"left":"left"==placement&&pos.left-actualWidth<parentDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){that.$element.trigger("shown.bs."+that.type),that.hoverState=null};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(150):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var arrowDelta=delta.left?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowPosition=delta.left?"left":"top",arrowOffsetPosition=delta.left?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],arrowPosition)},Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.trigger("hidden.bs."+that.type)}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(e),!e.isDefaultPrevented())return $tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(150):complete(),this.hoverState=null,this},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName;return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():null,{scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop(),width:isBody?$(window).width():$element.outerWidth(),height:isBody?$(window).height():$element.outerHeight()},isBody?{top:0,left:0}:$element.offset())},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},
Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.width&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var $e=this.$element,o=this.options;return $e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do{prefix+=~~(1e6*Math.random())}while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&((self=$(e.currentTarget).data("bs."+this.type))||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})}var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.2.0",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").empty()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},Popover.prototype.tip=function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip};var old=$.fn.popover;$.fn.popover=Plugin,$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),function($){"use strict";function ScrollSpy(element,options){var process=$.proxy(this.process,this);this.$body=$("body"),this.$scrollElement=$($(element).is("body")?window:element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",process),this.refresh(),this.process()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.scrollspy"),options="object"==typeof option&&option;data||$this.data("bs.scrollspy",data=new ScrollSpy(this,options)),"string"==typeof option&&data[option]()})}ScrollSpy.VERSION="3.2.0",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var offsetMethod="offset",offsetBase=0;$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var self=this;this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(href);return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){self.offsets.push(this[0]),self.targets.push(this[1])})},ScrollSpy.prototype.process=function(){var i,scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget;if(this.scrollHeight!=scrollHeight&&this.refresh(),scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<=offsets[0])return activeTarget!=(i=targets[0])&&this.activate(i);for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(!offsets[i+1]||scrollTop<=offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,$(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]',active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);Plugin.call($spy,$spy.data())})})}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),"string"==typeof option&&data[option]()})}var Tab=function(element){this.element=$(element)};Tab.VERSION="3.2.0",Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");if(selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")),!$this.parent("li").hasClass("active")){var previous=$ul.find(".active:last a")[0],e=$.Event("show.bs.tab",{relatedTarget:previous});if($this.trigger(e),!e.isDefaultPrevented()){var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),function(){$this.trigger({type:"shown.bs.tab",relatedTarget:previous})})}}},Tab.prototype.activate=function(element,container,callback){function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),element.addClass("active"),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu")&&element.closest("li.dropdown").addClass("active"),callback&&callback()}var $active=container.find("> .active"),transition=callback&&$.support.transition&&$active.hasClass("fade");transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(150):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this},$(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),Plugin.call($(this),"show")})}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix"),options="object"==typeof option&&option;data||$this.data("bs.affix",data=new Affix(this,options)),"string"==typeof option&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.2.0",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var scrollHeight=$(document).height(),scrollTop=this.$target.scrollTop(),position=this.$element.offset(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom;"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=!(null!=this.unpin&&scrollTop+this.unpin<=position.top)&&(null!=offsetBottom&&position.top+this.$element.height()>=scrollHeight-offsetBottom?"bottom":null!=offsetTop&&scrollTop<=offsetTop&&"top");if(this.affixed!==affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");this.$element.trigger(e),e.isDefaultPrevented()||(this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger($.Event(affixType.replace("affix","affixed"))),"bottom"==affix&&this.$element.offset({top:scrollHeight-this.$element.height()-offsetBottom}))}}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},data.offsetBottom&&(data.offset.bottom=data.offsetBottom),data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery)}),define("date",[],function(){!function(){Date.prototype.formatDate=function(input,time){var daysLong=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"];"undefined"!=typeof farecompare&&"resourceBundle"in farecompare&&(daysLong=farecompare.resourceBundle.daysLong,daysShort=farecompare.resourceBundle.daysShort,monthsShort=farecompare.resourceBundle.monthsShort,monthsLong=farecompare.resourceBundle.monthsLong);var date,switches={a:function(){return date.getHours()>11?"pm":"am"},A:function(){return this.a().toUpperCase()},B:function(){var off=60*(date.getTimezoneOffset()+60),theSeconds=3600*date.getHours()+60*date.getMinutes()+date.getSeconds()+off,beat=Math.floor(theSeconds/86.4);return beat>1e3&&(beat-=1e3),beat<0&&(beat+=1e3),1==String(beat).length&&(beat="00"+beat),2==String(beat).length&&(beat="0"+beat),beat},c:function(){return this.Y()+"-"+this.m()+"-"+this.d()+"T"+this.h()+":"+this.i()+":"+this.s()+this.P()},d:function(){var j=String(this.j());return 1==j.length?"0"+j:j},D:function(){return daysShort[date.getDay()]},F:function(){return monthsLong[date.getMonth()]},g:function(){return date.getHours()>12?date.getHours()-12:date.getHours()},G:function(){return date.getHours()},h:function(){var g=String(this.g());return 1==g.length?"0"+g:g},H:function(){var G=String(this.G());return 1==G.length?"0"+G:G},i:function(){var min=String(date.getMinutes());return 1==min.length?"0"+min:min},I:function(){return new Date("January 1 "+this.Y()+" 00:00:00").getTimezoneOffset()==date.getTimezoneOffset()?0:1},j:function(){return date.getDate()},l:function(){return daysLong[date.getDay()]},L:function(){var Y=this.Y();return Y%4==0&&Y%100!=0||Y%4==0&&Y%100==0&&Y%400==0?1:0},m:function(){var n=String(this.n());return 1==n.length?"0"+n:n},M:function(){return monthsShort[date.getMonth()]},n:function(){return date.getMonth()+1},N:function(){var w=this.w();return 0==w?7:w},O:function(){var os=Math.abs(date.getTimezoneOffset()),h=String(Math.floor(os/60)),m=String(os%60);return h=1==h.length?h="0"+h:1,m=1==m.length?m="0"+m:1,date.getTimezoneOffset()<0?"+"+h+m:"-"+h+m},P:function(){var O=this.O();return O.substr(0,3)+":"+O.substr(3,2)},r:function(){return this.D()+", "+this.d()+" "+this.M()+" "+this.Y()+" "+this.H()+":"+this.i()+":"+this.s()+" "+this.O()},s:function(){var sec=String(date.getSeconds());return 1==sec.length?"0"+sec:sec},S:function(){switch(date.getDate()){case 1:return"st";case 2:return"nd";case 3:return"rd";case 21:return"st";case 22:return"nd";case 23:return"rd";case 31:return"st";default:return"th"}},t:function(){var daysinmonths=[null,31,28,31,30,31,30,31,31,30,31,30,31];return 1==this.L()&&2==this.n()?29:daysinmonths[this.n()]},U:function(){return Math.round(date.getTime()/1e3)},w:function(){return date.getDay()},W:function(){var DoW=this.N(),DoY=this.z(),daysToNY=364+this.L()-DoY;if(daysToNY<=2&&DoW<=3-daysToNY)return 1;if(DoY<=2&&DoW>=5)return new Date(this.Y()-1,11,31).formatDate("W");var nyDoW=new Date(this.Y(),0,1).getDay();return nyDoW=0!=nyDoW?nyDoW-1:6,nyDoW<=3?1+Math.floor((DoY+nyDoW)/7):1+Math.floor((DoY-(7-nyDoW))/7)},y:function(){var y=String(this.Y());return y.substring(y.length-2,y.length)},Y:function(){var x;if(date.getFullYear){if(2001==(x=new Date("January 1 2001 00:00:00 +0000").getFullYear()))return date.getFullYear()}x=date.getYear();var y=x%100;return y+=y<38?2e3:1900},z:function(){var t=new Date("January 1 "+this.Y()+" 00:00:00"),diff=date.getTime()-t.getTime();return Math.floor(diff/1e3/60/60/24)},Z:function(){return-60*date.getTimezoneOffset()}};date=time?new Date(time):this;for(var formatString=input.split(""),i=0;i<formatString.length;)"\\"==formatString[i]?formatString.splice(i,1):formatString[i]=function(str){return void 0!=switches[str]?switches[str]():str}(formatString[i]),i++;return formatString.join("")},Date.prototype.getIDate=function(){return Number(this.formatDate(Date.DATE_IDATE))},Date.prototype.fromIDate=function(iDateOrDateTime){var idate;if(idate=iDateOrDateTime.date?Number(iDateOrDateTime.date):Number(iDateOrDateTime),this.setDate(1),this.setMonth(0),8==String(idate).length&&(this.setHours(12),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this.year=idate/1e4,this.year=this.year-this.year%1,this.month=(idate-1e4*this.year)/100,this.month=this.month-this.month%1-1,this.day=(idate-1e4*this.year)%100,this.setYear(this.year),this.setDate(this.day),this.setMonth(this.month)),iDateOrDateTime.time){var mins=0,hours=0,chars=String(iDateOrDateTime.time).split("");chars.length<=2?mins=chars.join(""):(mins=Number(chars[chars.length-2]+""+chars[chars.length-1]),hours=chars.length<4?Number(chars[0]):Number(chars[0]+""+chars[1])),this.setHours(hours),this.setMinutes(mins),this.setSeconds(0),this.setMilliseconds(0)}return this},Date.prototype.fromIDateCache=function(iDateOrDateTime){window._dateCache||(window._dateCache={});var cacheKey,idate;iDateOrDateTime.date?(idate=Number(iDateOrDateTime.date),cacheKey=iDateOrDateTime.date+" "+iDateOrDateTime.time):(idate=Number(iDateOrDateTime),cacheKey=iDateOrDateTime);var cachedResult=window._dateCache[cacheKey];if(cachedResult)return cachedResult;if(this.setDate(1),this.setMonth(0),8==String(idate).length&&(this.setHours(12),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this.year=idate/1e4,this.year=this.year-this.year%1,this.month=(idate-1e4*this.year)/100,this.month=this.month-this.month%1-1,this.day=(idate-1e4*this.year)%100,this.setYear(this.year),this.setDate(this.day),this.setMonth(this.month)),iDateOrDateTime.time){var mins=0,hours=0,chars=String(iDateOrDateTime.time).split("");chars.length<=2?mins=chars.join(""):(mins=Number(chars[chars.length-2]+""+chars[chars.length-1]),hours=chars.length<4?Number(chars[0]):Number(chars[0]+""+chars[1])),this.setHours(hours),this.setMinutes(mins),this.setSeconds(0),this.setMilliseconds(0)}return window._dateCache[cacheKey]=this,this},Date.parseMMDDYYDate=function(dateStr){var date=null;if("string"==typeof dateStr){dateStr.match(/\/$/)&&(dateStr=dateStr.substring(0,dateStr.length-1));var parts=dateStr.split(/[\/-]/);if(parts&&parts.length>=1&&parts[0].length>0){var month=parts[0],day=parts.length>=2&&parts[1].length>0?parts[1]:1,year=null;isNaN(Number(month))||isNaN(Number(day))||(date=Date._getNow(),parts.length<3?(year=Number(date.formatDate("Y")),Number(month)<date.getMonth()&&year++):2!=parts[2].length&&4!=parts[2].length||(year=Number(parts[2])),isNaN(year)||(year<100&&(year+=2e3),month.length<2&&(month="0"+month),String(day).length<2&&(day="0"+day),date.fromIDate(year+month+day)))}}else"date"==typeof dateStr&&(date=Date._getNow(),date.setDate(1),date.setMonth(0),date.setMonth(dateStr.getMonth()),date.setYear(dateStr.getYear()),date.setDate(dateStr.getDate()));return date},Date._getNow=function(time){var d=new Date;return time?d:(d.setHours(12),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0),d)},Date.DATE_ATOM="Y-m-d\\TH:i:sP",Date.DATE_ISO8601="Y-m-d\\TH:i:sO",Date.DATE_RFC2822="D, d M Y H:i:s O",Date.DATE_W3C="Y-m-d\\TH:i:sP",Date.DATE_IDATE="Ymd",Date.DATE_IDATE_NO_DAY="Ym",Date.DATE_MMDDYYYY="m/d/Y",Date.DATE_MDY="n/j/Y",Date.DATE_MDY_WITH_ZEROS=Date.DATE_MMDDYYYY,Date.DATE_MMYY_TIME="m/d g:i A",Date.DATE_MONTH_AND_YEAR_2="M y",Date.DATE_MONTH_AND_YEAR_4="M Y",Date.DATE_DAY_OF_MONTH="d",Date.DATE_YEAR_4="Y",Date.DATE_YEAR_2="y",Date.DATE_MONTH_2="m",Date}()}),define("jq.c",["jquery"],function(jQuery){!function($){function encode(s){return config.raw?s:encodeURIComponent(s)}function decode(s){return config.raw?s:decodeURIComponent(s)}function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value))}function parseCookieValue(s){0===s.indexOf('"')&&(s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s=decodeURIComponent(s.replace(pluses," ")),config.json?JSON.parse(s):s}catch(e){}}function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value}var pluses=/\+/g,config=$.cookie=function(key,value,options){if(void 0!==value&&!$.isFunction(value)){if(options=$.extend({},config.defaults,options),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setTime(+t+864e5*days)}return document.cookie=[encode(key),"=",stringifyCookieValue(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}for(var result=key?void 0:{},cookies=document.cookie?document.cookie.split("; "):[],i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split("="),name=decode(parts.shift()),cookie=parts.join("=");if(key&&key===name){result=read(cookie,value);break}key||void 0===(cookie=read(cookie))||(result[name]=cookie)}return result};config.defaults={},$.removeCookie=function(key,options){return void 0!==$.cookie(key)&&($.cookie(key,"",$.extend({},options,{expires:-1})),!$.cookie(key))}}(jQuery)}),define("query.string",["jquery"],function($){return toQueryParams=function(queryString){if(""==queryString)return{};queryString=queryString.replace(/^[\?#]/,"");for(var comps=queryString.split("&"),paramMap={},i=0;i<comps.length;++i){var p=comps[i].split("=");1==p.length?paramMap[p[0]]=!0:2==p.length&&(paramMap[p[0]]=decodeURIComponent(p[1].replace(/\+/g," ")))}return paramMap},$.QueryParams=toQueryParams(window.location.search),toQueryParams}),define("embed.helper",["jquery","query.string","jq.c"],function($){Array.prototype.indexOf||(Array.prototype.indexOf=function(obj,start){for(var i=start||0,j=this.length;i<j;i++)if(this[i]===obj)return i;return-1});var eh=function(options){this.init(options)};return eh.prototype={init:function(options){var defaults={sessionExpire:7,cookieDomain:"."+document.domain,cookiePath:"/",cookieName:"_fc_utmp_",utm_params:["email_jobid"],created:(new Date).getTime()};this.options=$.extend({},options||{},defaults);var fc_utmp=this._getPersistedCookie(),utmz=this.getParamsFromUtmZ(),paramsFromUrl=this.getParamsFromUrl(),sevenDaysAgo=new Date;sevenDaysAgo.setDate(sevenDaysAgo.getDate()-7);var attribution=null;fc_utmp.created?utmz.updated>fc_utmp.created&&(attribution=utmz):attribution=utmz.updated>sevenDaysAgo.getTime()?utmz:{utm_medium:"(none)",utm_source:"(direct)",utm_campaign:"(direct)",utm_content:"(fc_7_day_attribution)"},delete utmz.updated,attribution&&this.saveCookie($.extend({created:(new Date).getTime()},attribution,paramsFromUrl))},saveCookie:function(cookieData){$.cookie(this.options.cookieName,JSON.stringify(cookieData),{expires:this.options.sessionExpire,domain:this.options.cookieDomain,path:this.options.cookiePath})},_getPersistedUtmParams:function(){var rv=this._getPersistedCookie()||{},deviceId=$.cookie("deviceId");return void 0!==deviceId&&(rv.deviceId=deviceId),rv},_getPersistedCookie:function(){var rv={created:0},cookieData=$.cookie(this.options.cookieName);if(void 0!==cookieData)try{rv=JSON.parse(cookieData)}catch(ignore){}return rv},getParamsFromUtmZ:function(){var params={},utmz=$.cookie("__utmz");if(utmz){var vals=utmz.split(".utm");if(vals&&vals.length>1){var dateFields=vals[0].split(".");dateFields.length>1&&(params.updated=1e3*Number(dateFields[1]));for(var utmVals=("utm"+vals[vals.length-1]).split("|"),i=0,size=utmVals.length;i<size;++i){var nv=utmVals[i].split("=");if(nv&&nv.length>0)switch(nv[0]){case"utmcsr":params.utm_source=nv[1];break;case"utmcmd":params.utm_medium=nv[1];break;case"utmccn":params.utm_campaign=nv[1];break;case"utmcct":params.utm_content=nv[1];break;case"utmgclid":params.gclid=nv[1]}}}}return params},getParamsFromUrl:function(){var params={},i=0,names=this.options.utm_params;return $.each($.QueryParams,function(name,value){-1!=names.indexOf(name)&&(i++,params[name]=value)}),params},persistDeviceIdIfNeeded:function(){null==$.cookie("deviceId")&&$.ajax({async:!1,url:"/ajax/util/getDeviceId.json"})}},eh}),define("jsrender",["jquery"],function(jQuery){!function(global,jQuery,undefined){"use strict";function retVal(val){return val}function dbgBreak(val){return val}function dbgMode(debugMode){$viewsSettings._dbgMode=debugMode,indexStr=debugMode?"Error: #index in nested view: use #getIndex()":"",$tags("dbg",$helpers.dbg=$converters.dbg=debugMode?dbgBreak:retVal)}function DataMap(getTarget){return{getTgt:getTarget,map:function(source){var theMap=this;if(theMap.src!==source&&(theMap.src&&theMap.unmap(),"object"==typeof source)){var target=getTarget.apply(theMap,arguments);theMap.src=source,theMap.tgt=target}}}}function JsViewsError(message,object){object&&object.onError&&!1===object.onError(message)||(this.name="JsRender Error",this.message=message||"JsRender error")}function $extend(target,source){var name;target=target||{};for(name in source)target[name]=source[name];return target}function $viewsDelimiters(openChars,closeChars,link){return $viewsSub.rTag&&!openChars||(delimOpenChar0=openChars?openChars.charAt(0):delimOpenChar0,delimOpenChar1=openChars?openChars.charAt(1):delimOpenChar1,delimCloseChar0=closeChars?closeChars.charAt(0):delimCloseChar0,delimCloseChar1=closeChars?closeChars.charAt(1):delimCloseChar1,linkChar=link||linkChar,openChars="\\"+delimOpenChar0+"(\\"+linkChar+")?\\"+delimOpenChar1,closeChars="\\"+delimCloseChar0+"\\"+delimCloseChar1,rTag="(?:(?:(\\w+(?=[\\/\\s\\"+delimCloseChar0+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+delimCloseChar0+"]|\\"+delimCloseChar0+"(?!\\"+delimCloseChar1+"))*?)",$viewsSub.rTag=rTag+")",rTag=new RegExp(openChars+rTag+"(\\/)?|(?:\\/(\\w+)))"+closeChars,"g"),rTmplString=new RegExp("<.*>|([^\\\\]|^)[{}]|"+openChars+".*"+closeChars)),[delimOpenChar0,delimOpenChar1,delimCloseChar0,delimCloseChar1,linkChar]}function getView(inner,type){type||(type=inner,inner=undefined);var views,i,l,found,view=this,root=!type||"root"===type;if(inner){if(!(found=view.type===type?view:undefined))if(views=view.views,view._.useKey){for(i in views)if(found=views[i].get(inner,type))break}else for(i=0,l=views.length;!found&&i<l;i++)found=views[i].get(inner,type)}else if(root)for(;view.parent.parent;)found=view=view.parent;else for(;view&&!found;)found=view.type===type?view:undefined,view=view.parent;return found}function getNestedIndex(){var view=this.get("item");return view?view.index:undefined}function getIndex(){return this.index}function getHelper(helper){var wrapped,view=this,ctx=view.linkCtx,res=(view.ctx||{})[helper];return res===undefined&&ctx&&ctx.ctx&&(res=ctx.ctx[helper]),res===undefined&&(res=$helpers[helper]),res&&("function"!=typeof res||res._wrp||(wrapped=function(){return res.apply(this&&this!==global?this:view,arguments)},wrapped._wrp=1,$extend(wrapped,res))),wrapped||res}function convertVal(converter,view,tagCtx){var tmplConverter,tag,value,boundTagCtx=+tagCtx===tagCtx&&tagCtx,linkCtx=view.linkCtx;return boundTagCtx&&(tagCtx=(boundTagCtx=view.tmpl.bnds[boundTagCtx-1])(view.data,view,$views)),value=tagCtx.args[0],(converter||boundTagCtx)&&(tag=linkCtx&&linkCtx.tag||{_:{inline:!linkCtx,bnd:boundTagCtx},tagName:converter+":",flow:!0,_is:"tag"},linkCtx&&(linkCtx.tag=tag,tag.linkCtx=tag.linkCtx||linkCtx,tagCtx.ctx=extendCtx(tagCtx.ctx,linkCtx.view.ctx)),tag.tagCtx=tagCtx,tagCtx.view=view,tag.ctx=tagCtx.ctx||{},delete tagCtx.ctx,view._.tag=tag,converter="true"!==converter&&converter,converter&&((tmplConverter=view.getRsc("converters",converter))||error("Unknown converter: {{"+converter+":"))&&(tag.depends=tmplConverter.depends,value=tmplConverter.apply(tag,tagCtx.args)),value=value!=undefined?value:"",value=boundTagCtx&&view._.onRender?view._.onRender(value,view,boundTagCtx):value,view._.tag=undefined),value}function getResource(resourceType,itemName){for(var res,store,view=this;res===undefined&&view;)store=view.tmpl[resourceType],res=store&&store[itemName],view=view.parent;return res||$views[resourceType][itemName]}function renderTag(tagName,parentView,tmpl,tagCtxs,isRefresh){var render,tag,tags,attr,parentTag,i,l,itemRet,tagCtx,tagCtxCtx,content,boundTagFn,tagDef,callInit,map,thisMap,args,ret="",boundTagKey=+tagCtxs===tagCtxs&&tagCtxs,linkCtx=parentView.linkCtx||0,ctx=parentView.ctx,parentTmpl=tmpl||parentView.tmpl,parentView_=parentView._;for("tag"===tagName._is&&(tag=tagName,tagName=tag.tagName),boundTagKey&&(tagCtxs=(boundTagFn=parentTmpl.bnds[boundTagKey-1])(parentView.data,parentView,$views)),l=tagCtxs.length,tag=tag||linkCtx.tag,i=0;i<l;i++)tagCtx=tagCtxs[i],content=tagCtx.tmpl,content=tagCtx.content=content&&parentTmpl.tmpls[content-1],tmpl=tagCtx.props.tmpl,i||tmpl&&tag||(tagDef=parentView.getRsc("tags",tagName)||error("Unknown tag: {{"+tagName+"}}")),tmpl=tmpl||(tag||tagDef).template||content,tmpl=""+tmpl===tmpl?parentView.getRsc("templates",tmpl)||$templates(tmpl):tmpl,$extend(tagCtx,{tmpl:tmpl,render:renderContent,index:i,view:parentView,ctx:extendCtx(tagCtx.ctx,ctx)}),tag||(tagDef._ctr?(tag=new tagDef._ctr,callInit=!!tag.init,tag.attr=tag.attr||tagDef.attr||undefined):tag={render:tagDef.render},tag._={inline:!linkCtx},linkCtx&&(linkCtx.attr=tag.attr=linkCtx.attr||tag.attr,linkCtx.tag=tag,tag.linkCtx=linkCtx),(tag._.bnd=boundTagFn||linkCtx.fn)?tag._.arrVws={}:tag.dataBoundOnly&&error("{^{"+tagName+"}} tag must be data-bound"),tag.tagName=tagName,tag.parent=parentTag=ctx&&ctx.tag,tag._is="tag",tag._def=tagDef),tagCtx.tag=tag,tag.map&&tag.tagCtxs&&(tagCtx.map=tag.tagCtxs[i].map),tag.flow||(tagCtxCtx=tagCtx.ctx=tagCtx.ctx||{},tags=tag.parents=tagCtxCtx.parentTags=ctx&&extendCtx(tagCtxCtx.parentTags,ctx.parentTags)||{},parentTag&&(tags[parentTag.tagName]=parentTag),tagCtxCtx.tag=tag);for(tag.tagCtxs=tagCtxs,parentView_.tag=tag,tag.rendering={},i=0;i<l;i++)tagCtx=tag.tagCtx=tagCtxs[i],args=tagCtx.args,(map=tagCtx.props.map||tag).map&&(args.length||!i||tagCtx.props.map)&&(args.length||(args=[parentView.data]),thisMap=tagCtx.map=$extend(tagCtx.map||{unmap:map.unmap},tagCtx.props),thisMap.src!==args[0]&&(thisMap.src&&thisMap.unmap(),map.map.apply(thisMap,args)),args=[thisMap.tgt]),tag.ctx=tagCtx.ctx,!i&&callInit&&(tag.init(tagCtx,linkCtx,tag.ctx),tagCtx=tag.tagCtx,callInit=undefined),itemRet=undefined,render=tag.render,(render=tag.render)&&(itemRet=render.apply(tag,args)),itemRet=itemRet!==undefined?itemRet:tagCtx.tmpl&&tagCtx.render(args[0],undefined,!0)||(isRefresh?undefined:""),ret=ret?ret+(itemRet||""):itemRet;return delete tag.rendering,tag.tagCtx=tag.tagCtxs[0],tag.ctx=tag.tagCtx.ctx,tag._.inline&&(attr=tag.attr)&&attr!==htmlStr&&(ret="text"===attr?$converters.html(ret):""),boundTagKey&&parentView._.onRender?parentView._.onRender(ret,parentView,boundTagKey):ret}function View(context,type,parentView,data,template,key,contentTmpl,onRender){var views,parentView_,tag,isArray="array"===type,self_={key:0,useKey:isArray?0:1,id:""+viewId++,onRender:onRender,bnds:{}},self={data:data,tmpl:template,content:contentTmpl,views:isArray?[]:{},parent:parentView,type:type,get:getView,getIndex:getIndex,getRsc:getResource,hlp:getHelper,_:self_,_is:"view"};return parentView?(views=parentView.views,parentView_=parentView._,parentView_.useKey?(views[self_.key="_"+parentView_.useKey++]=self,self.index=indexStr,self.getIndex=getNestedIndex,tag=parentView_.tag,self_.bnd=isArray&&(!tag||!!tag._.bnd&&tag)):views.splice(self_.key=self.index=key,0,self),self.ctx=context||parentView.ctx):self.ctx=context,self}function compileChildResources(parentTmpl){var storeName,resources,resourceName,settings,compile;for(storeName in jsvStores)if(settings=jsvStores[storeName],(compile=settings.compile)&&(resources=parentTmpl[storeName+"s"]))for(resourceName in resources)resources[resourceName]=compile(resourceName,resources[resourceName],parentTmpl,storeName,settings)}function compileTag(name,tagDef,parentTmpl){var init,tmpl;return"function"==typeof tagDef?tagDef={depends:tagDef.depends,render:tagDef}:((tmpl=tagDef.template)&&(tagDef.template=""+tmpl===tmpl?$templates[tmpl]||$templates(tmpl):tmpl),!1!==tagDef.init&&(init=tagDef._ctr=function(tagCtx){},(init.prototype=tagDef).constructor=init)),parentTmpl&&(tagDef._parentTmpl=parentTmpl),tagDef}function compileTmpl(name,tmpl,parentTmpl,storeName,storeSettings,options){function tmplOrMarkupFromStr(value){
if(""+value===value||value.nodeType>0){try{elem=value.nodeType>0?value:!rTmplString.test(value)&&jQuery&&jQuery(global.document).find(value)[0]}catch(e){}return elem&&(value=elem.getAttribute(tmplAttr),name=name||value,(value=$templates[value])||(name=name||"_"+autoTmplName++,elem.setAttribute(tmplAttr,name),value=$templates[name]=compileTmpl(name,elem.innerHTML,parentTmpl,storeName,storeSettings,options))),value}}var tmplOrMarkup,elem;if(tmpl=tmpl||"",tmplOrMarkup=tmplOrMarkupFromStr(tmpl),options=options||(tmpl.markup?tmpl:{}),options.tmplName=name,parentTmpl&&(options._parentTmpl=parentTmpl),!tmplOrMarkup&&tmpl.markup&&(tmplOrMarkup=tmplOrMarkupFromStr(tmpl.markup))&&(!tmplOrMarkup.fn||tmplOrMarkup.debug===tmpl.debug&&tmplOrMarkup.allowCode===tmpl.allowCode||(tmplOrMarkup=tmplOrMarkup.markup)),tmplOrMarkup!==undefined)return name&&!parentTmpl&&($render[name]=function(){return tmpl.render.apply(tmpl,arguments)}),tmplOrMarkup.fn||tmpl.fn?tmplOrMarkup.fn&&(tmpl=name&&name!==tmplOrMarkup.tmplName?extendCtx(options,tmplOrMarkup):tmplOrMarkup):(tmpl=TmplObject(tmplOrMarkup,options),tmplFn(tmplOrMarkup.replace(rEscapeQuotes,"\\$&"),tmpl)),compileChildResources(options),tmpl}function TmplObject(markup,options){var htmlTag,wrapMap=$viewsSettings.wrapMap||{},tmpl=$extend({markup:markup,tmpls:[],links:{},tags:{},bnds:[],_is:"template",render:renderContent},options);return options.htmlTag||(htmlTag=rFirstElem.exec(markup),tmpl.htmlTag=htmlTag?htmlTag[1].toLowerCase():""),htmlTag=wrapMap[tmpl.htmlTag],htmlTag&&htmlTag!==wrapMap.div&&(tmpl.markup=$.trim(tmpl.markup)),tmpl}function renderContent(data,context,noIteration,parentView,key,onRender){var i,l,dataItem,newView,childView,itemResult,swapContent,tagCtx,contentTmpl,tag_,outerOnRender,tmplName,tmpl,self=this,allowDataLink=!self.attr||self.attr===htmlStr,result="";if(!0===key&&(swapContent=!0,key=0),self.tag?(tagCtx=self,self=self.tag,tag_=self._,tmplName=self.tagName,tmpl=tagCtx.tmpl,context=extendCtx(context,self.ctx),contentTmpl=tagCtx.content,!1===tagCtx.props.link&&(context=context||{},context.link=!1),parentView=parentView||tagCtx.view,data=data===undefined?parentView:data):tmpl=self.jquery&&(self[0]||error('Unknown template: "'+self.selector+'"'))||self,tmpl&&(!parentView&&data&&"view"===data._is&&(parentView=data),parentView&&(contentTmpl=contentTmpl||parentView.content,onRender=onRender||parentView._.onRender,data===parentView&&(data=parentView.data,noIteration=!0),context=extendCtx(context,parentView.ctx)),parentView&&parentView.data!==undefined||((context=context||{}).root=data),tmpl.fn||(tmpl=$templates[tmpl]||$templates(tmpl)),tmpl)){if(onRender=!1!==(context&&context.link)&&allowDataLink&&onRender,outerOnRender=onRender,!0===onRender&&(outerOnRender=undefined,onRender=parentView._.onRender),context=tmpl.helpers?extendCtx(tmpl.helpers,context):context,$.isArray(data)&&!noIteration)for(newView=swapContent?parentView:key!==undefined&&parentView||View(context,"array",parentView,data,tmpl,key,contentTmpl,onRender),i=0,l=data.length;i<l;i++)dataItem=data[i],childView=View(context,"item",newView,dataItem,tmpl,(key||0)+i,contentTmpl,onRender),itemResult=tmpl.fn(dataItem,childView,$views),result+=newView._.onRender?newView._.onRender(itemResult,childView):itemResult;else newView=swapContent?parentView:View(context,tmplName||"data",parentView,data,tmpl,key,contentTmpl,onRender),tag_&&!self.flow&&(newView.tag=self),result+=tmpl.fn(data,newView,$views);return outerOnRender?outerOnRender(result,newView):result}return""}function error(message){throw new $viewsSub.Error(message)}function syntaxError(message){error("Syntax error\n"+message)}function tmplFn(markup,tmpl,isLinkExpr,convertBack){function pushprecedingContent(shift){(shift-=loc)&&content.push(markup.substr(loc,shift).replace(rNewLine,"\\n"))}function blockTagCheck(tagName){tagName&&syntaxError('Unmatched or missing tag: "{{/'+tagName+'}}" in template:\n'+markup)}function parseTag(all,bind,tagName,converter,colon,html,comment,codeTag,params,slash,closeBlock,index){html&&(colon=":",converter=htmlStr),slash=slash||isLinkExpr;var noError,current0,pathBindings=bind&&[],code="",hash="",passedCtx="",block=!slash&&!colon&&!comment;tagName=tagName||colon,pushprecedingContent(index),loc=index+all.length,codeTag?allowCode&&content.push(["*","\n"+params.replace(rUnescapeQuotes,"$1")+"\n"]):tagName?("else"===tagName&&(rTestElseIf.test(params)&&syntaxError('for "{{else if expr}}" use "{{else expr}}"'),pathBindings=current[6],current[7]=markup.substring(current[7],index),current=stack.pop(),content=current[3],block=!0),params&&(params=params.replace(rNewLine," "),code=parseParams(params,pathBindings,tmpl).replace(rBuildHash,function(all,isCtx,keyValue){return isCtx?passedCtx+=keyValue+",":hash+=keyValue+",",""})),hash=hash.slice(0,-1),code=code.slice(0,-1),noError=hash&&hash.indexOf("noerror:true")+1&&hash||"",newNode=[tagName,converter||!!convertBack||"",code,block&&[],'params:"'+params+'",props:{'+hash+"}"+(passedCtx?",ctx:{"+passedCtx.slice(0,-1)+"}":""),noError,pathBindings||0],content.push(newNode),block&&(stack.push(current),current=newNode,current[7]=loc)):closeBlock&&(current0=current[0],blockTagCheck(closeBlock!==current0&&"else"!==current0&&closeBlock),current[7]=markup.substring(current[7],index),current=stack.pop()),blockTagCheck(!current&&closeBlock),content=current[3]}var newNode,allowCode=tmpl&&tmpl.allowCode,astTop=[],loc=0,stack=[],content=astTop,current=[,,,astTop];return blockTagCheck(stack[0]&&stack[0][3].pop()[0]),markup.replace(rTag,parseTag),pushprecedingContent(markup.length),(loc=astTop[astTop.length-1])&&blockTagCheck(""+loc!==loc&&+loc[7]===loc[7]&&loc[0]),buildCode(astTop,isLinkExpr?markup:tmpl,isLinkExpr)}function buildCode(ast,tmpl,isLinkExpr){var i,node,tagName,converter,params,hash,hasTag,hasEncoder,getsVal,hasCnvt,useCnvt,tmplBindings,pathBindings,nestedTmpls,tmplName,nestedTmpl,tagAndElses,content,markup,nextIsElse,oldCode,isElse,isGetVal,prm,tagCtxFn,tmplBindingKey=0,code="",noError="",tmplOptions={},l=ast.length;for(""+tmpl===tmpl?(tmplName=isLinkExpr?'data-link="'+tmpl.replace(rNewLine," ").slice(1,-1)+'"':tmpl,tmpl=0):(tmplName=tmpl.tmplName||"unnamed",tmpl.allowCode&&(tmplOptions.allowCode=!0),tmpl.debug&&(tmplOptions.debug=!0),tmplBindings=tmpl.bnds,nestedTmpls=tmpl.tmpls),i=0;i<l;i++)if(""+(node=ast[i])===node)code+='\nret+="'+node+'";';else if("*"===(tagName=node[0]))code+=""+node[1];else{if(converter=node[1],params=node[2],content=node[3],hash=node[4],noError=node[5],markup=node[7],(isElse="else"===tagName)||(tmplBindingKey=0,tmplBindings&&(pathBindings=node[6])&&(tmplBindingKey=tmplBindings.push(pathBindings))),(isGetVal=":"===tagName)?(converter&&(tagName=converter===htmlStr?">":converter+tagName),noError&&(prm="prm"+i,noError="try{var "+prm+"=["+params+"][0];}catch(e){"+prm+'="";}\n',params=prm)):(content&&(nestedTmpl=TmplObject(markup,tmplOptions),nestedTmpl.tmplName=tmplName+"/"+tagName,buildCode(content,nestedTmpl),nestedTmpls.push(nestedTmpl)),isElse||(tagAndElses=tagName,oldCode=code,code=""),nextIsElse=ast[i+1],nextIsElse=nextIsElse&&"else"===nextIsElse[0]),hash+=",args:["+params+"]}",isGetVal&&pathBindings||converter&&">"!==tagName){if(tagCtxFn=new Function("data,view,j,u"," // "+tmplName+" "+tmplBindingKey+" "+tagName+"\n"+noError+"return {"+hash+";"),tagCtxFn.paths=pathBindings,tagCtxFn._ctxs=tagName,isLinkExpr)return tagCtxFn;useCnvt=1}if(code+=isGetVal?"\n"+(pathBindings?"":noError)+(isLinkExpr?"return ":"ret+=")+(useCnvt?(useCnvt=0,hasCnvt=!0,'c("'+converter+'",view,'+(pathBindings?(tmplBindings[tmplBindingKey-1]=tagCtxFn,tmplBindingKey):"{"+hash)+");"):">"===tagName?(hasEncoder=!0,"h("+params+");"):(getsVal=!0,"(v="+params+")!="+(isLinkExpr?"=":"")+'u?v:"";')):(hasTag=!0,"{view:view,tmpl:"+(content?nestedTmpls.length:"0")+","+hash+","),tagAndElses&&!nextIsElse){if(code="["+code.slice(0,-1)+"]",(isLinkExpr||pathBindings)&&(code=new Function("data,view,j,u"," // "+tmplName+" "+tmplBindingKey+" "+tagAndElses+"\nreturn "+code+";"),pathBindings&&((tmplBindings[tmplBindingKey-1]=code).paths=pathBindings),code._ctxs=tagName,isLinkExpr))return code;code=oldCode+'\nret+=t("'+tagAndElses+'",view,this,'+(tmplBindingKey||code)+");",pathBindings=0,tagAndElses=0}}code="// "+tmplName+"\nvar j=j||"+(jQuery?"jQuery.":"js")+"views"+(getsVal?",v":"")+(hasTag?",t=j._tag":"")+(hasCnvt?",c=j._cnvt":"")+(hasEncoder?",h=j.converters.html":"")+(isLinkExpr?";\n":',ret="";\n')+($viewsSettings.tryCatch?"try{\n":"")+(tmplOptions.debug?"debugger;":"")+code+(isLinkExpr?"\n":"\nreturn ret;\n")+($viewsSettings.tryCatch?"\n}catch(e){return j._err(e);}":"");try{code=new Function("data,view,j,u",code)}catch(e){syntaxError("Compiled template code:\n\n"+code,e)}return tmpl&&(tmpl.fn=code),code}function parseParams(params,bindings,tmpl){function parseTokens(all,lftPrn0,lftPrn,bound,path,operator,err,eq,path2,prn,comma,lftPrn2,apos,quot,rtPrn,rtPrnDot,prn2,space,index,full){function parsePath(allPath,not,object,helper,view,viewProperty,pathTokens,leafToken){if(object&&(bindings&&("linkTo"===named&&(bindto=bindings._jsvto=bindings._jsvto||[],bindto.push(path)),named&&!boundName||bindings.push(path.slice(not.length))),"."!==object)){var ret=(helper?'view.hlp("'+helper+'")':view?"view":"data")+(leafToken?(viewProperty?"."+viewProperty:helper?"":view?"":"."+object)+(pathTokens||""):(leafToken=helper?"":view?viewProperty||"":object,""));return ret+=leafToken?"."+leafToken:"",not+("view.data"===ret.slice(0,9)?ret.slice(5):ret)}return allPath}var expr;if(operator=operator||"",lftPrn=lftPrn||lftPrn0||lftPrn2,path=path||path2,prn=prn||prn2||"",!err||aposed||quoted)return bindings&&rtPrnDot&&!aposed&&!quoted&&(!named||boundName||bindto)&&(expr=pathStart[parenDepth],full.length-1>index-expr&&(expr=full.slice(expr,index+1),rtPrnDot=delimOpenChar1+":"+expr+delimCloseChar0,rtPrnDot=tmplLinks[rtPrnDot]=tmplLinks[rtPrnDot]||tmplFn(delimOpenChar0+rtPrnDot+delimCloseChar1,tmpl,!0),rtPrnDot.paths||parseParams(expr,rtPrnDot.paths=[],tmpl),(bindto||bindings).push({_jsvOb:rtPrnDot}))),aposed?(aposed=!apos,aposed?all:'"'):quoted?(quoted=!quot,quoted?all:'"'):(lftPrn?(parenDepth++,pathStart[parenDepth]=index++,lftPrn):"")+(space?parenDepth?"":named?(named=boundName=bindto=!1,"\b"):",":eq?(parenDepth&&syntaxError(params),named=path,boundName=bound,"\b"+path+":"):path?path.split("^").join(".").replace(rPath,parsePath)+(prn?(fnCall[++parenDepth]=!0,"."!==path.charAt(0)&&(pathStart[parenDepth]=index),prn):operator):operator||(rtPrn?(fnCall[parenDepth--]=!1,rtPrn+(prn?(fnCall[++parenDepth]=!0,prn):"")):comma?(fnCall[parenDepth]||syntaxError(params),","):lftPrn0?"":(aposed=apos,quoted=quot,'"')));syntaxError(params)}var named,bindto,boundName,tmplLinks=tmpl.links,fnCall={},pathStart={0:-1},parenDepth=0,quoted=!1,aposed=!1;return(params+" ").replace(/\)\^/g,").").replace(rParams,parseTokens)}function extendCtx(context,parentContext){return context&&context!==parentContext?parentContext?$extend($extend({},parentContext),context):context:parentContext&&$extend({},parentContext)}function getCharEntity(ch){return charEntities[ch]||(charEntities[ch]="&#"+ch.charCodeAt(0)+";")}function getTargetProps(source){var key,prop,props=[];if("object"==typeof source)for(key in source)(prop=source[key])&&prop.toJSON&&!prop.toJSON()||"function"!=typeof prop&&props.push({key:key,prop:source[key]});return props}if(!(jQuery&&jQuery.views||global.jsviews)){var $,jsvStoreName,rTag,rTmplString,indexStr,delimOpenChar0="{",delimOpenChar1="{",delimCloseChar0="}",delimCloseChar1="}",linkChar="^",rPath=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,rParams=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*\.|\s*\^|\s*$)|[)\]])([([]?))|(\s+)/g,rNewLine=/[ \t]*(\r\n|\n|\r)/g,rUnescapeQuotes=/\\(['"])/g,rEscapeQuotes=/['"\\]/g,rBuildHash=/\x08(~)?([^\x08]+)\x08/g,rTestElseIf=/^if\s/,rFirstElem=/<(\w+)[>\s]/,rAttrEncode=/[\x00`><"'&]/g,rHtmlEncode=rAttrEncode,autoTmplName=0,viewId=0,charEntities={"&":"&amp;","<":"&lt;",">":"&gt;","\0":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;"},htmlStr="html",tmplAttr="data-jsv-tmpl",$render={},jsvStores={template:{compile:compileTmpl},tag:{compile:compileTag},helper:{},converter:{}},$views={jsviews:"v1.0.0-beta",render:$render,settings:function(settings){$extend($viewsSettings,settings),dbgMode($viewsSettings._dbgMode),$viewsSettings.jsv&&$viewsSettings.jsv()},sub:{View:View,Error:JsViewsError,tmplFn:tmplFn,parse:parseParams,extend:$extend,error:error,syntaxError:syntaxError,DataMap:DataMap},_cnvt:convertVal,_tag:renderTag,_err:function(e){return $viewsSettings._dbgMode?"Error: "+(e.message||e)+". ":""}};(JsViewsError.prototype=new Error).constructor=JsViewsError,getNestedIndex.depends=function(){return[this.get("item"),"index"]},getIndex.depends=function(){return["index"]};for(jsvStoreName in jsvStores)!function(storeName,storeSettings){function theStore(name,item,parentTmpl){var onStore,compile,itemName,thisStore;if(name&&""+name!==name&&!name.nodeType&&!name.markup){for(itemName in name)theStore(itemName,name[itemName],item);return $views}return item===undefined&&(item=name,name=undefined),name&&""+name!==name&&(parentTmpl=item,item=name,name=undefined),thisStore=parentTmpl?parentTmpl[storeNames]=parentTmpl[storeNames]||{}:theStore,compile=storeSettings.compile,(onStore=$viewsSub.onBeforeStoreItem)&&(compile=onStore(thisStore,name,item,compile)||compile),name?null===item?delete thisStore[name]:thisStore[name]=compile?item=compile(name,item,parentTmpl,storeName,storeSettings):item:item=compile(undefined,item),compile&&item&&(item._is=storeName),(onStore=$viewsSub.onStoreItem)&&onStore(thisStore,name,item,compile),item}var storeNames=storeName+"s";$views[storeNames]=theStore,jsvStores[storeName]=storeSettings}(jsvStoreName,jsvStores[jsvStoreName]);var $observable,$templates=$views.templates,$converters=$views.converters,$helpers=$views.helpers,$tags=$views.tags,$viewsSub=$views.sub,$viewsSettings=$views.settings;jQuery?($=jQuery,$.fn.render=renderContent,($observable=$.observable)&&($extend($viewsSub,$observable.sub),delete $observable.sub)):($=global.jsviews={},$.isArray=Array&&Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)}),$.render=$render,$.views=$views,$.templates=$templates=$views.templates,$viewsSettings({debugMode:dbgMode,delimiters:$viewsDelimiters,_dbgMode:!0,tryCatch:!0}),$tags({else:function(){},if:{render:function(val){var self=this;return self.rendering.done||!val&&(arguments.length||!self.tagCtx.index)?"":(self.rendering.done=!0,self.selected=self.tagCtx.index,self.tagCtx.render())},onUpdate:function(ev,eventArgs,tagCtxs){var tci,prevArg,different;for(tci=0;(prevArg=this.tagCtxs[tci])&&prevArg.args.length;tci++)if(prevArg=prevArg.args[0],different=!prevArg!=!tagCtxs[tci].args[0],prevArg||different)return different;return!1},flow:!0},for:{render:function(val){var self=this,tagCtx=self.tagCtx,result="",done=0;return arguments.length||(val=tagCtx.view.data),self.rendering.done||(val!==undefined&&(result+=tagCtx.render(val),done+=$.isArray(val)?val.length:1),(self.rendering.done=done)&&(self.selected=tagCtx.index)),result},flow:!0},include:{flow:!0},"*":{render:retVal,flow:!0}}),$tags({props:$extend($extend({},$tags.for),DataMap(getTargetProps))}),$converters({html:function(text){return text!=undefined?String(text).replace(rHtmlEncode,getCharEntity):""},attr:function(text){return text!=undefined?String(text).replace(rAttrEncode,getCharEntity):null===text?text:""},url:function(text){return text!=undefined?encodeURI(String(text)):null===text?text:""}}),$viewsDelimiters()}}(this,this.jQuery||jQuery||{failed:!0})}),define("default-departure",["jquery"],function($){function onDefaultDepartureSuccess(response){if(window.defaultDeparture.response=response,window.defaultDeparture.pending.length>0)for(var i=0,size=window.defaultDeparture.pending.length;i<size;++i){var cb=window.defaultDeparture.pending[i].done;"function"==typeof cb&&cb(response,window.defaultDeparture.pending[i].options)}}function onDefaultDepartureFail(response){if(window.defaultDeparture.pending.length>0)for(var i=0,size=window.defaultDeparture.pending.length;i<size;++i){var cb=window.defaultDeparture.pending[i].fail;"function"==typeof cb&&cb(response)}}function onDefaultDepartureAlways(response){if(window.defaultDeparture.pending.length>0)for(var i=0,size=window.defaultDeparture.pending.length;i<size;++i){var cb=window.defaultDeparture.pending[i].always;"function"==typeof cb&&cb(response)}}return{initDefaultDeparture:function(options,doneCallback,failCallback,alwaysCallback){window.defaultDeparture&&window.defaultDeparture.pending&&0!=window.defaultDeparture.pending.length?window.defaultDeparture.response?doneCallback(options,window.defaultDeparture.response):window.defaultDeparture.pending.push({done:doneCallback,fail:failCallback,always:alwaysCallback,options:options}):(jQuery.ajax({url:"/ajax/util/getDefaultDeparture.html",cache:!1,data:{},defaultDeparture:this,dataType:"json"}).done(onDefaultDepartureSuccess).fail(onDefaultDepartureFail).always(onDefaultDepartureAlways),window.defaultDeparture={pending:[{done:doneCallback,fail:failCallback,always:alwaysCallback,options:options}]})}}}),define("simple.class",[],function(){var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;return this.Class=function(){},Class.extend=function(prop){function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]="function"==typeof prop[name]&&"function"==typeof _super[name]&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];return Class.prototype=prototype,Class.prototype.constructor=Class,Class.extend=arguments.callee,Class},Class}),define("deals-widget",["jquery","default-departure","jsrender","simple.class"],function($,defaultDeparture,_jsrender,Class){return Class.extend({init:function(){this.options={successCallback:$.proxy(this.onPopulateContainerSuccess,this),containerSelector:"#deals-container",numberOfMarketsToReturn:7,linkToProfile:!0,itemTemplate:'<li json="{{>json}}"><span class="city">{{>destinationName}} ({{>destinationCode}})</span> <span class="price">{{>price}}</span></li>'}},initiateCalls:function(myOptions){this.options=$.extend(this.options,myOptions||{}),$.templates("itemTemplate",this.options.itemTemplate),this.options.originCityCode?this._loadWidget(this.options):defaultDeparture.initDefaultDeparture(this.options,$.proxy(this.onDefaultDepartureSuccess,this),$.proxy(this.onDefaultDepartureFailure,this),$.proxy(this.onDefaultDepartureAlways,this))},onDefaultDepartureSuccess:function(response,options){options.originCityCode=response.cityLocation.code,this._loadWidget(options)},onDefaultDepartureFailure:function(response){},onDefaultDepartureAlways:function(response){},_loadWidget:function(options){var params={siteCode:options.siteCode,originCityCode:options.originCityCode,destinationCityCodes:options.destinationCityCodes,tripType:"roundtrip",numberOfMarketsToReturn:options.numberOfMarketsToReturn};options.firstDepartDate&&(params.firstDepartDate=options.firstDepartDate),options.lastDepartDate&&(params.lastDepartDate=options.lastDepartDate),options.includeCarriers&&(params.includeCarriers=options.includeCarriers.split(/,/)),options.excludeCarriers&&(params.excludeCarriers=options.excludeCarriers.split(/,/)),$.ajax({url:"/ajax/deals-widget/getDealInfosFromOrigin.html",cache:!1,data:params,traditional:!0,options:options,dataType:"json"}).done(this.options.successCallback).fail($.proxy(this.onServerFailure,this)).always($.proxy(this.onServerAlways,this))},onPopulateContainerSuccess:function(response){if(null!=response.JSON&&"success"==response.JSON){var container=$(this.options.containerSelector);if(container&&container.length>0){var $container=$(container[0]),html=["<div id='dealsWidget-flight-deals'><h2>"];html.push(response.response.title),html.push("</h2><div class='from'>"),this.options.linkToProfile&&html.push("<a href='/12q/dashboard.html#menu:Preferences'>"),html.push(this.getFromCodeMap(response.response.codeMap,response.response.originCityCode)+" "),this.options.linkToProfile&&html.push("</a> "),html.push(response.response.to),html.push(" ...</div>"),html.push("<ul>");var that=this;$.each(response.response.deals,function(code,deal){var props={origin:response.response.originCityCode,destination:code,departDate:deal.dd,returnDate:deal.rd},templateData={json:JSON.stringify(props),destinationName:that.getFromCodeMap(response.response.codeMap,code),destinationCode:code,price:deal.p};html.push($.templates.itemTemplate.render(templateData))}),html.push("</ul>"),html.push("<p class='disclaimer'>"),html.push(response.response.disclaimer),html.push("</p></div>"),$container.html(html.join(""))}}},onServerFailure:function(response){},onServerAlways:function(response){},getFromCodeMap:function(codeMap,key){var value=codeMap[key];return value||key}})}),define("identify",["jquery"],function(jQuery){!function($){$.fn.identify=function(prefix){var i=0;return this.each(function(){if(!this.id){do{i++;var id=prefix+"_"+i}while($("#"+id).length>0);$(this).attr("id",id)}})}}(jQuery)}),define("browser.info",[],function(){var BrowserInfo=function(){this.init()};return BrowserInfo.prototype={detect:void 0,browser:void 0,isIE:!1,OS:void 0,version:void 0,thestring:void 0,place:void 0,init:function(){this.detect=navigator.userAgent.toLowerCase()},getBrowserInfo:function(){this.checkIt("konqueror")?(this.browser="Konqueror",this.OS="Linux"):this.checkIt("safari")?this.browser="Safari":this.checkIt("omniweb")?this.browser="OmniWeb":this.checkIt("opera")?this.browser="Opera":this.checkIt("webtv")?this.browser="WebTV":this.checkIt("icab")?this.browser="iCab":this.checkIt("msie")?this.browser="Internet Explorer":this.checkIt("compatible")?this.browser="An unknown browser":(this.browser="Netscape Navigator",this.version=this.detect.charAt(8)),this.isIE11=this._isIE&&navigator.userAgent.match(/Trident.*rv:11.*/),this.version||(this.version=this.detect.charAt(this.place+this.thestring.length)),this.OS||(this.checkIt("linux")?this.OS="Linux":this.checkIt("x11")?this.OS="Unix":this.checkIt("mac")?this.OS="Mac":this.checkIt("win")?this.OS="Windows":this.OS="an unknown operating system")},checkIt:function(string){return this.place=this.detect.indexOf(string)+1,this.thestring=string,this.place}},BrowserInfo}),define("lightbox",["jquery","browser.info","simple.class","clone.position"],function($,BrowserInfo,Class){return Class.extend({yPos:0,xPos:0,init:function(el,callback,actionCallbacks,options){this.ctrl=$(el),this.callback=callback,this.actionCallbacks=actionCallbacks;var defaults={overlayDiv:"lightbox-overlay",lightboxDiv:"lightbox-container"};this.options=$.extend({},defaults,options||{}),this.activateListener=$.proxy(this.activate,this),this.redoInit(this.ctrl),this.lbId=defaults.lightboxDiv,this.browserInfo=new BrowserInfo,this.browserInfo.getBrowserInfo(),this._isIE6=this.browserInfo.isIE&&6==this.browserInfo.version,this.handleEscapeKey=function(event){var lb=$("#"+this.lbId);lb.length>0&&lb.is(":visible")&&27==event.which&&lb.find(".lbAction[rel=deactivate]").trigger("click")},$(document).keyup($.proxy(this.handleEscapeKey,this))},redoInit:function(el){this.ctrl&&this.undoInit();var ctrl=$(el);ctrl&&(ctrl.click(this.activateListener),ctrl.onclick=function(){return!1},this.ctrl=ctrl)},undoInit:function(){this.ctrl&&$(this.ctrl)&&(this.ctrl.onclick=null,this.ctrl=null)},addLightboxMarkup:function(){var body=$(document.body);if(0==$("#"+this.options.overlayDiv).length){var overlay=document.createElement("div");overlay.id=this.options.overlayDiv,$(body).prepend(overlay)}var lightBox=$("#"+this.lbId);if(this.attaching){var div=document.createElement("div");div.id=this.lbId+"_tmp",$(body).append(div),div=$("#"+this.lbId+"_tmp"),div.clonePosition(lightBox),$(body).append(lightBox),lightBox.css({top:div.css("top"),left:div.css("left")}),div.remove()}else if(0==lightBox.length){var lb=document.createElement("div");lb.id=this.lbId,lb.style.display="none",lb.className="loading",$(body).append(lb),lightBox=$("#"+this.lbId)}},attachLightbox:function(div){this.lbId=div,this.attaching=!0,this.activate({}),this.actions()},activate:function(event){this.addLightboxMarkup(this.options.lightboxContainer),this.browserInfo.isIE&&this.browserInfo.version<8&&(this.getScroll(),this.prepareIE("100%","hidden"),this.setScroll(0,0),this.hideSelects("hidden")),this.displayLightbox(event,"block"),"undefined"!=typeof safariHelper&&safariHelper.fixUp(this.lbId);var calendar=$("#unique__calendar__unique");calendar.length>0&&calendar.visible()&&calendar.hide();var suggestion=$("#__suggestions__");suggestion.length>0&&suggestion.visible()&&suggestion.hide()},prepareIE:function(height,overflow){var bod=$(document.body);bod.css("height",height,"overflow",overflow),bod.parents(".html").css("height",height,"overflow",overflow)},hideSelects:function(val){"hidden"==val?$(document.body).addClass("lbIEModal"):$(document.body).removeClass("lbIEModal")},getScroll:function(){self.pageYOffset?this.yPos=self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?this.yPos=document.documentElement.scrollTop:document.body&&(this.yPos=document.body.scrollTop)},setScroll:function(x,y){window.scrollTo(x,y)},displayLightbox:function(event,display){var overlay=$("#"+this.options.overlayDiv);overlay&&overlay.css("display",display);var lb=$("#"+this.lbId);lb&&(lb.css("display",display),"none"==display||this.attaching?$(document.body).removeClass("lb-modal"):($(document.body).addClass("lb-modal"),this.loadInfo(event)))},loadInfo:function(event){this.callback&&this.processInfo({responseText:this.callback(event)})},processInfo:function(response){var lb=$("#"+this.lbId);if(lb.removeClass("loading").addClass("done"),lb.css("visibility","hidden"),lb.html("<div id='lbContent'><div id='lbData'>"+response.responseText+"</div></div>"),this.options&&this.options.center&&Position.Center)Position.Center(lb,null);else if(this.options&&this.options.position&&this.options.lightboxContainer){var container=$(this.options.lightboxContainer);if(container){var top=0,left=0,parentFixed="fixed"==lb.css("position");if(parentFixed||this.isIE6)top=document.viewport.getHeight()/2-$(this.lbId).getHeight()/2,top<0&&(top=0),left=document.viewport.getWidth()/2-$(this.lbId).getWidth()/2,left<0&&(left=0),lb.css({top:top+"px",left:left+"px"});else{var scrollPosition=document.viewport.getScrollOffsets();top=this.options.position.top+scrollPosition.top,left=this.options.position.left+scrollPosition.left,lb.clonePosition(container,{setHeight:!1,setWidth:!1,offsetTop:top,offsetLeft:left})}}}lb.css("visibility","visible"),this.options&&0!=$(this.options.form).length&&Form.focusFirstElement(this.options.form),this.actions()},setStatusMessage:function(response){$("lbStatus").innerHTML=response.responseText?response.responseText:response},actions:function(){for(var lbActions=$("#"+this.lbId).find(".lbAction"),i=0,len=lbActions.length;i<len;++i){var lbAction=lbActions[i];lbAction.rel=lbAction.getAttribute("rel"),lbAction&&lbAction.rel&&("deactivate"==lbAction.rel||"insert"==lbAction.rel||"submit"==lbAction.rel?$(lbAction).click($.proxy(this[lbAction.rel],this)):"onLoad"==lbAction.rel?this.actionCallbacks[lbAction.rel](lbAction):(void 0==this.actionCallbacks[lbAction.rel]&&alert("Configuration error: "+lbAction.rel+" Callback not present"),$(lbAction).click($.proxy(this.actionCallbacks[lbAction.rel],this.actionCallbacks[lbAction.rel]))),"onLoad"!=lbAction.rel&&(lbAction.onclick=function(){return!1}))}},removeActions:function(){var parent=$(this.lbId);if(parent)for(var lbActions=parent.select(".lbAction"),i=0,len=lbActions.length;i<len;++i){var lbAction=lbActions[i];lbAction.rel=lbAction.getAttribute("rel"),lbAction&&lbAction.rel&&(lbAction.onclick=null)}},insert:function(){this.close(),this.actionCallbacks.insert&&this.processInfo({responseText:this.actionCallbacks.insert()})},submit:function(e){var link=e.currentTarget.parent();this.actionCallbacks.onSubmit?this.actionCallbacks.onSubmit(link,this)&&this.submitData(link):this.submitData(link)},onSubmitOk:function(transport){this.actionCallbacks.onSubmitOk?this.actionCallbacks.onSubmitOk(transport,this)&&this.deactivate():this.deactivate()},onSubmitError:function(transport){alert("Submit Error: "+transport)},submitData:function(link){new Ajax.Request(link.href,{method:"get",parameters:"",onSuccess:$.proxy(this.onSubmitOk,this),onException:$.proxy(this.onSubmitError,this)})},close:function(){$("#lbContent").remove()},doUnload:function(){this.actionCallbacks.onunload&&this.actionCallbacks.onunload(this)},deactivate:function(event){this.displayLightbox(event,"none"),this.doUnload(),this.removeActions(),this.close(),"Internet Explorer"==this.browserInfo.browser&&this.browserInfo.version<8&&(this.setScroll(0,this.yPos),this.prepareIE("auto","auto"),this.hideSelects("visible")),this.attaching&&($(this.lbId).remove(),this.attaching=!1,this.lbId="lightbox")},getViewportSize:function(){return void 0!==window.innerWidth?[window.innerWidth,window.innerHeight]:void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[$(document.body).clientWidth,$(document.body).clientHeight]},getScrollingPosition:function(){var position=[0,0];return void 0!==window.pageYOffset&&(position=[window.pageXOffset,window.pageYOffset]),void 0!==document.documentElement.scrollTop&&document.documentElement.scrollTop>0?position=[document.documentElement.scrollLeft,document.documentElement.scrollTop]:void 0!==document.body.scrollTop&&(position=[document.body.scrollLeft,document.body.scrollTop]),position}})}),define("roadblock",["jquery","lightbox","simple.class","jsrender"],function($,Lightbox,Class){var RoadBlockController=Class.extend({init:function(options){options=options||{},this.div=null;var defaults=$.extend(!0,{},options||{});defaults.templateValues={wrapper_class:"default"},defaults.trigger={className:"blocked",event:"mousedown",onshow:options.onshow},defaults.lightboxOptions={center:!0,language:"en"},defaults.lightboxCallbacks={onLoad:$.proxy(this.onLoad,this),onunload:$.proxy(this.lightboxClose,this),onSubmit:$.proxy(this.lightboxSubmit,this),insert:$.proxy(this._buildFinished,this)},defaults.urls={roadblock_frame_template:"roadblock",roadblock_content_template:"simple",roadblock_button_template:"roadblock_button"},defaults.cssOptions={},this.options=this._updateDefaults(defaults,options),this.lightbox=new Lightbox(null,$.proxy(this._buildHtml,this),this.options.lightboxCallbacks,this.options.lightboxOptions);var selector;selector=this.options.trigger.className?"."+this.options.trigger.className:this.options.trigger.element;$(selector).bind(this.options.trigger.event,$.proxy(this._show,this)),$.when(this.lazyGetTemplate(this.options.urls.roadblock_content_template),this.lazyGetTemplate(this.options.urls.roadblock_frame_template))},_updateDefaults:function(defaults,options){return defaults.lightboxOptions||(defaults.lightboxOptions={}),defaults.lightboxCallbacks||(defaults.lightboxCallbacks={}),defaults.urls||(defaults.urls={}),defaults.trigger||(defaults.trigger={}),defaults.templateValues||(defaults.templateValues={}),defaults.properties||(defaults.properties={}),defaults.textad||(defaults.textad={}),defaults.signupOptions||(defaults.signupOptions={}),defaults.generalOptions||(defaults.generalOptions={}),
defaults.lightboxOptions=$.extend({},defaults.lightboxOptions,options.lightboxOptions||{}),defaults.lightboxCallbacks=$.extend({},defaults.lightboxCallbacks,options.lightboxCallbacks||{}),defaults.urls=$.extend({},defaults.urls,options.urls||{}),defaults.trigger=$.extend({},defaults.trigger,options.trigger||{}),defaults.templateValues=$.extend({},defaults.templateValues,options.templateValues||{}),defaults.properties=$.extend({},defaults.properties,options.properties||{}),defaults.textad=$.extend({},defaults.textad,options.textad||{}),defaults.cssOptions=$.extend({},defaults.cssOptions,options.cssOptions||{}),defaults.signupOptions=$.extend({},defaults.signupOptions,options.signupOptions||{}),defaults.generalOptions=$.extend({},defaults.generalOptions,options.generalOptions||{}),options&&options.trackingCategory&&(defaults.trackingCategory=options.trackingCategory),defaults},_activate:function(event){this.options.trigger.cancel&&event.stopPropagation(),this.eventTarget=event.target,this.lightbox.activate()},_show:function(e){"daily"==this.options.frequency?0===$.cookie(this.options.cookieName).length&&($.cookie(this.options.cookieName,"true",{expired:1}),this._showRoadblock(e)):this._showRoadblock(e)},_showRoadblock:function(e){this.lightbox.activate(),this.options.trigger.onshow&&this.options.trigger.onshow()},_updateActions:function(){this.lightbox.removeActions(),this.lightbox.actions()},lightboxSubmit:function(){},lightboxClose:function(){"function"==typeof this.options.properties.after?this.options.properties.after():this.eventTarget&&$(this.eventTarget).click()},lazyGetTemplate:function(name){var deferred=$.Deferred();if($.templates[name])deferred.resolve($.templates[name]);else{var url="/resources/v3/components/roadblock/templates/"+name+".tmpl."+this.options.lightboxOptions.language;$.get(url).then(function(response){$.templates(name,response),$.templates[name]?deferred.resolve($.templates[name]):(window.console&&console.log("Failed to load template :"+name+": at url "+url),deferred.reject($.templates[name]))})}return deferred.promise()},_buildHtml:function(){return this._renderHtml($.templates[this.options.urls.roadblock_content_template],$.templates[this.options.urls.roadblock_frame_template])},_renderHtml:function(content_tmpl,frame_tmpl){var content=content_tmpl.render(this.options.templateValues);return frame_tmpl.render($.extend({},this.options.templateValues,{roadblock:content}))},_buildFinished:function(){var content=$.templates[this.options.urls.roadblock_finished_template].render(this.options.templateValues);return $.templates[this.options.urls.roadblock_frame_template].render({roadblock:content})},onLoad:function(){this.options.dragSelector},trackEvent:function(category,action,label,value){try{"undefined"==typeof pageTracker&&"undefined"!=typeof _gaq?_gaq.push(["_trackEvent",category,action,label,value]):"undefined"!=typeof pageTracker&&"function"==typeof pageTracker._trackEvent&&pageTracker._trackEvent(category,action,label,value)}catch(ex){}},_destroy:function(){this.options=null,this.templateLoader=null,this.actionCallbacks=null,$(window).unbind("unload",this.destroyListener),this.destroyListener=null,this.lightbox.undoInit()}});RoadBlockController.extend({init:function(options){var defaults={title:"Farecompare.com",text:"",frequency:"",cookieName:"",action:"deactivate",href:"",src:"",alt:"OK"};this.sup($.extend({},defaults,options))}}),RoadBlockController.extend({init:function(options){this.validator=new ui.Validate;var defaults={properties:{submitUrl:"#",form:""}};this._updateDefaults(defaults,options),this.sup(defaults)},lightboxSubmit:function(){if(this.validator.form(this.options.properties.form,alert)){var values=$(this.options.properties.form).serialize();values.fromRoadblock=!0,new Ajax.Request(this.options.properties.submitUrl,{parameters:values,onSuccess:this._submitOk.bind(this),onError:this._submitError.bind(this),method:"get"})}},_submitOk:function(response){},_submitError:function(response){},_destroy:function(){this.sup()}});return $.templates("roadblock",'<div id="roadblock_wrapper" class="{{:wrapper_class}}">\n\t<div class="roadblock">\n\t\t<div class="border">\n\t\t\t<div class="title lbAction" rel="onLoad">\n\t\t\t\t<div class="close"><a class="lbAction" rel="deactivate">Close</a></div>\n\t\t\t</div>\n\t\t\t<div class="padding">\n\t\t\t\t<div class="roadblockdata">\n\t\t\t\t\t{{:roadblock}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'),$.templates("simple",'<div class="lb_title">{{:title}}</div>\n<br/>\n<div id="simple_lb_text" class="lb_text">\n    {{:text}}\n</div>\n<div class="lb_text">\n    {{:button}}\n</div>\n'),$.templates("roadblock_button",'<br/>\n <a class="lbAction" rel="{{:action}}" href="{{:href}}"><img src="{{:src}}" alt="{{:alt}}"/></a>'),$.templates("empty-container",'\x3c!-- default roadblock frame --\x3e\n<div id="roadblock_wrapper" class="{{:wrapper_class}}">\n\n\t<div class="roadblock" style="{{:style}}">\n        {{:roadblock}}\n\t</div>\n\n</div>\t'),$.templates("ad_roadblock",'\x3c!-- title, text, button --\x3e\n<div class="roadblock_ad">\n    <div class="border">\n        <div class="title lbAction" rel="onLoad">\n            <div class="close"><a class="lbAction" rel="deactivate">Close</a></div>\n        </div>\n        <div class="roadblockdata">\n            {{:roadblock}}\n        </div>\n    </div>\n</div>\n'),$.templates("adroadblock",'<div id="ad-roadblock" class="ad-roadblock">\n\n</div>\n'),$.templates("tip-content",'<div class="smart-tip">\n\t<div class="tip-title-big">{{:tipTitle}}</div>\n\t<div class="tip-close lbAction" rel="deactivate">Close this Window</div>\n\t<div class="tip-move dndhandle">Move this Window</div>\n\t<div class="tip-video">\n\t\t<object width="425" height="350">\n\t\t\t<param name="movie" value="http://www.youtube.com/v/{{:tipVideoUrl}}" />\n\t\t\t<embed src="http://www.youtube.com/v/{{:tipVideoUrl}}" type="application/x-shockwave-flash" width="425" height="350" />\n\t\t</object>\n\t</div>\n\t<div class="tip-text">\n\t\t<div class="tip-title">{{:tipTitle}}</div>\n\t\t{{:tipText}}\n\t</div>\n\t<div class="tip-ad">{{:ad}}</div>\n</div>'),RoadBlockController}),define("jquery.callout",["jquery"],function($){jQuery.fn.callout=function(options){return this.each(function(){var caller=this;if("hide"==options){var cots=caller.callout;if(cots)for(var c=0;c<cots.length;c++)cots[c].onCalloutBeforeHide(),cots[c].fadeOut(cots[c].data("fadeOut"),cots[c].onCalloutAfterHide)}else if("show"==options){var cots=caller.callout;if(cots)for(var c=0;c<cots.length;c++)cots[c].onCalloutBeforeShow(),cots[c].fadeIn(cots[c].data("fadeIn"),cots[c].onCalloutAfterShow);$(caller).callout("reorder")}else if("destroy"==options){var cots=caller.callout;if(cots)for(var c=0;c<cots.length;c++)cots[c].onCalloutBeforeDestroy(),cots[c].fadeOut(cots[c].data("fadeOut"),function(){$(this).remove()});delete caller.callout}else if("reorder"==options){var cots=caller.callout,ltop=$(caller).offset().top,lleft=$(caller).offset().left;if(cots)for(var c=0;c<cots.length;c++)if(cots[c].is(":visible")){cots[c].onCalloutBeforeReorder();var ctop=cots[c].offset().top,cleft=cots[c].offset().left,ltdiff=ltop-cots[c].attr("top"),lldiff=lleft-cots[c].attr("left");cots[c].css("top",ctop+ltdiff),cots[c].css("left",cleft+lldiff),cots[c].attr("top",ltop),cots[c].attr("left",lleft),cots[c].onCalloutAfterReorder()}}else{"string"==typeof options&&(options={msg:options}),options=$.extend({width:"auto",height:"auto",position:"top",align:"center",pointer:"center",msg:"Example Text",css:"",show:"true",fadeIn:2e3,fadeOut:1e3,zindex:10,afterCreate:function(){},beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},beforeDestroy:function(){},beforeReorder:function(){},afterReorder:function(){}},options||{});var position=options.position,width=options.width,height=options.height,msg=options.msg,align=options.align,pointer=options.pointer,css=options.css,zindex=options.zindex,$co=$("<div class='callout_main'></div>"),$cont=$("<div class='callout "+css+" callout_cont_"+position+"'>"+msg+"</div>"),$tri=$("<div class='callout_tri callout_"+position+"'></div>"),$tri2=$("<div></div>");$tri.append($tri2),$co.css("position","absolute").hide(),$cont.css("zIndex",zindex+1),$tri.css("height",0).css("width",0).css("border","10px solid transparent").css("zIndex",zindex),$tri2.css("position","relative").css("border","10px solid transparent").css("height",0).css("width",0).css("zIndex",zindex+2),$co.data("fadeout",options.fadeOut).data("fadein",options.fadeIn),$co.onCalloutBeforeShow=options.beforeShow,$co.onCalloutBeforeHide=options.beforeHide,$co.onCalloutBeforeDestroy=options.beforeDestroy,$co.onCalloutBeforeReorder=options.beforeReorder,$co.onCalloutAfterCreate=options.afterCreate,$co.onCalloutAfterShow=options.afterShow,$co.onCalloutAfterHide=options.afterHide,$co.onCalloutAfterReorder=options.afterReorder,$co.append($cont),"bottom"==position||"right"==position?$co.prepend($tri):$co.append($tri),$("body").append($co);for(var importStyle=new Array("backgroundColor","borderTopColor","borderLeftColor","borderRightColor","borderBottomColor","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","marginTop","marginLeft","marginRight","marginBottom"),s={},i=0;i<importStyle.length;i++)s[importStyle[i]]=$cont.style(importStyle[i]);$co.css("marginLeft",s.marginLeft).css("marginRight",s.marginRight).css("marginTop",s.marginTop).css("marginBottom",s.marginBottom),$cont.css("margin",0);var left=-1e3,top=-1e3;$co.css("left",left),$co.css("top",top),$co.show(),"auto"!=width&&$co.css("width",width),"auto"!=height&&$cont.css("height",height),width=$cont.width(),height=$cont.height();var ttop=$(caller).offset().top,tleft=$(caller).offset().left,callerRight=parseInt($(caller).css("right"),10);callerRight<0&&(tleft-=callerRight);var twidth=$(caller).width(),theight=$(caller).height();switch($co.attr("left",tleft),$co.attr("top",ttop),"top"==position||"bottom"==position?("bottom"!=align&&"top"!=align||(align="center"),"bottom"!=pointer&&"top"!=pointer||(pointer="center")):("left"!=align&&"right"!=align||(align="center"),"left"!=pointer&&"right"!=pointer||(pointer="center")),pointer){case"none":$tri.hide();break;case"left":$tri.css("marginLeft",10);break;case"right":$tri.css("marginLeft",width>18?width-10-8:0);break;case"top":$tri.css("top",10);break;case"bottom":$tri.css("top",height>18?height-10-8:0)}switch(align){case"left":left=tleft;break;case"right":left=tleft+twidth-width-8;break;case"top":top=ttop;break;case"bottom":top=ttop+theight-height-10}switch(position){case"top":case"bottom":"top"==position?(top=ttop-height-25,$tri.css("marginTop",-1).css("borderTopColor",s.borderBottomColor),$tri2.css("borderTopColor",s.backgroundColor).css("left",-10).css("top",-12)):(top=ttop+theight+5,$tri.css("marginBottom",-1).css("borderBottomColor",s.borderTopColor),$tri2.css("borderBottomColor",s.backgroundColor).css("left",-10).css("top",-8)),"center"==align&&(left=tleft+twidth/2-width/2),"center"==pointer?$tri.css("marginLeft",width/2-8):"left"==pointer&&"right"==align?left=tleft+twidth-25:"right"==pointer&&"left"==align&&(left=tleft-width+25);break;case"left":case"right":"left"==position?(left=tleft-width-25,$tri.css("left",width+10+1),$tri.css("borderLeftColor",s.borderRightColor),$tri2.css("borderLeftColor",s.backgroundColor).css("left",-12).css("top",-10)):(left=tleft+twidth+15,$tri.css("left",-19),$tri.css("borderRightColor",s.borderLeftColor),$tri2.css("borderRightColor",s.backgroundColor).css("left",-8).css("top",-10)),$tri.css("position","absolute"),"center"==align&&(top=ttop+theight/2-height/2-6),"center"==pointer?$tri.css("top",height/2-4):"top"==pointer&&"bottom"==align?top=ttop+theight-30:"bottom"==pointer&&"top"==align&&(top=ttop-height+20)}$co.hide(),$co.css("left",left),$co.css("top",top),$co.onCalloutAfterCreate(),options.show&&($co.onCalloutBeforeShow(),$co.fadeIn($co.data("fadeIn"),$co.onCalloutAfterShow)),void 0==caller.callout&&(caller.callout=new Array,$(window).bind("resize",function(e){$(caller).callout("reorder")})),caller.callout.push($co)}}),this},jQuery.fn.style=function(property){var el=this[0];return el.currentStyle?el.currentStyle[property]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(el,"")[property]:el.style[property]}}),define("outer.html",["jquery"],function($){!function($){$.fn.outerHTML=function(s){return s?this.before(s).remove():$("<p>").append(this.eq(0).clone()).html()}}(jQuery)}),define("validation",["jquery"],function($){var Validation=function(){this.init()};return Validation.prototype={init:function(){this._emailValidationRegEx=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i},validateAndConfirmPassword:function(newPassword,confirmPassword,errorDiv){return newPassword!=confirmPassword?(errorDiv.html("Passwords do not match.").show(),!1):this.validatePassword(newPassword,errorDiv)},validatePassword:function(newPassword,errorDiv){var $div=$("#"+errorDiv);return newPassword.length<8||newPassword.length>16?($div.html("Password must be between 8 and 16 characters in length.").show(),!1):!(!isNaN(newPassword)||!newPassword.match(/[0-9]/))||($div.html("Password must contain at least 1 letter and 1 number.").show(),!1)},_validateAndConfirmEmail:function(email,confirm,sendAlert,errorDiv){var msg="",$div=null;return errorDiv&&($div=$("#"+errorDiv)),email!=confirm?(msg="Email addresses do not match, please try again.",$div&&$div.html(msg).show(),sendAlert&&alert(msg),!1):this._validateEmail(email,sendAlert,errorDiv)},_validateEmail:function(email,sendAlert,errorDiv){var msg="",$div=null;return errorDiv&&($div=$("#"+errorDiv)),0==email.length?(msg="Please specify a valid email address.",$div&&$div.html(msg).show(),sendAlert&&alert(msg),!1):!!this._emailValidationRegEx.test(email)||(msg="Please specify a valid email address. (i.e. bob@farecompare.com)",$div&&$div.html(msg).show(),sendAlert&&alert(msg),!1)}},Validation}),define("fitText",["jquery"],function($){!function($){$.fn.fitText=function(kompressor,options){var compressor=kompressor||1,settings=$.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},options);return this.each(function(){var $this=$(this),resizer=function(){$this.css("font-size",Math.max(Math.min($this.width()/(10*compressor),parseFloat(settings.maxFontSize)),parseFloat(settings.minFontSize)))};resizer(),$(window).on("resize.fittext orientationchange.fittext",resizer)})}}(jQuery)}),define("getAttributes",["jquery"],function(jQuery){!function($){$.fn.getAttributes=function(){var attributes={};return this.length&&$.each(this[0].attributes,function(index,attr){attributes[attr.name]=attr.value}),attributes},function(old){$.fn.attr=function(){if(0===arguments.length){if(0===this.length)return null;var obj={};return $.each(this[0].attributes,function(){this.specified&&(obj[this.name]=this.value)}),obj}return old.apply(this,arguments)}}($.fn.attr)}(jQuery)}),define("clone.position",["jquery"],function(jQuery){!function($){$.fn.clonePosition=function(element,options){var options=$.extend({setLeft:!0,setTop:!0,setWidth:!1,setHeight:!1,offsetLeft:0,offsetTop:0},options||{}),el=$(this),src=$(element),p=(el.offset(),[src.offset().left,src.offset().top]),delta=[0,0],delta_size=[0,0];return"absolute"==el.css("position")&&(d=el.offset(),delta[0]=d.left,delta[1]=d.top),delta_size[0]=(el.outerWidth()-src.outerWidth())/2,delta_size[1]=(el.outerHeight()-src.outerHeight())/2,null==document.body&&(delta[0]-=document.body.offsetLeft,delta[1]-=document.body.offsetTop),options.setLeft&&el.css("left",p[0]-delta[0]+options.offsetLeft-delta_size[0]+"px"),options.setTop&&el.css("top",p[1]-delta[1]+options.offsetTop-delta_size[1]+"px"),options.setWidth&&el.width(src.width()+"px"),options.setHeight&&el.height(src.height()+"px"),el}}(jQuery),function($){$.fn.positionedOffset=function(){var coords=$(this).offset(),parent=$(this).offsetParent(),parentCoords=$(parent).offset();return{left:coords.left-parentCoords.left,top:coords.top-parentCoords.top}}}(jQuery)}),define("price.conversion2",["jquery"],function(jQuery){return function($){var PriceConversion=function(code,currencies){this.init(code,currencies)};return PriceConversion.prototype={init:function(code,currencies){this._currencies=currencies,this._code=code||"USD"},setCurrencies:function(currencies){this._currencies=currencies},getCode:function(){return this._code},setCode:function(code){this._code=code},getCurrencySymbol:function(){return this._currencies[this._code].currencyHtmlCode},getPrice:function(usdPrice,code){return usdPrice<=0?0:this.convertPrice(usdPrice,this._currencies[code||this._code].conversionRate)},getPriceString:function(usdPrice,code){var code=code||this._code,factor=Number(this._currencies[code].conversionRate);return this._currencies[code].currencyHtmlCode+(usdPrice>0?this.convertPrice(usdPrice,factor):0)},updatePrices:function(code,el,attr){var _this=this;if(attr=attr||"data-price",el=el||"body",!code||!this._currencies[code])return void console.log("No conversion for "+code);var f=this._currencies[code].conversionRate;if(f){var factor=Number(f),symbol=code in this._currencies?this._currencies[code].currencyHtmlCode:code;$.each($(el).find("["+attr+"]"),function(i,el){var $priceEl=$(el),usdPrice=$priceEl.attr(attr);if(0!==Number(usdPrice)){var convertPrice=_this.convertPrice(usdPrice,factor);$priceEl.html(symbol+convertPrice)}})}},convertPrice:function(price,factor){return Math.ceil(Number(price)*factor)}},PriceConversion}(jQuery)}),define("mlrt",["jquery"],function(jQuery){!function($){$.fn.responsiveTable=function(options){var settings=$.extend({headerSelector:"thead td, thead th, tr th",bodyRowSelector:"tbody tr",responsiveRowElement:"<dl></dl>",responsiveColumnTitleElement:"<dt></dt>",responsiveColumnValueElement:"<dd></dd>",enable:!0},options);return this.each(function(j,e){var $this=$(this),result=$('<div class="ml-responsive-table ml-responsive-table-'+j+'" />'),titles=new Array;$this.find(settings.headerSelector).each(function(i,e){var title=$(this).html();titles[i]=title}),$this.find(settings.bodyRowSelector).each(function(i,e){var row=$(settings.responsiveRowElement);row.addClass("ml-grid ml-clearfix ml-row-"+i),$(this).children("td").each(function(ii,ee){var dt=$(settings.responsiveColumnTitleElement);dt.addClass("ml-title col-"+ii+" ml-table"),dt.html(titles[ii]);var dd=$(settings.responsiveColumnValueElement);dd.addClass("ml-value col-"+ii+" ml-table"),dd.html($(this).html()),""==$.trim($(this).html())&&(dd.addClass("empty"),dt.addClass("empty")),row.append(dt).append(dd)}),result.append(row)}),settings.enable?($this.after(result),$this.hide()):($(".ml-responsive-table").detach(),$this.show())})}}(jQuery),function($){$.fn.MagicLiquidizerTable=function(options){var settings=$.extend({table:"1",breakpoint:"720",whichelement:"table"},options);return this.each(function(){function responsiveTableFn(){$(window).width()<settings.breakpoint?($("html").addClass("rwd-table"),"1"==settings.table&&!$(".ml-responsive-table").length>0&&$(settings.whichelement).responsiveTable({enable:!0})):($("html").removeClass("rwd-table"),"1"==settings.table&&$(settings.whichelement).responsiveTable({enable:!1}))}$(window).resize(responsiveTableFn).ready(responsiveTableFn)})}}(jQuery)}),define("fitVids",["jquery"],function(jQuery){!function($){"use strict";$.fn.fitVids=function(options){var settings={customSelector:null,ignore:null};if(!document.getElementById("fit-vids-style")){var head=document.head||document.getElementsByTagName("head")[0],div=document.createElement("div");div.innerHTML='<p>x</p><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>',head.appendChild(div.childNodes[1])}return options&&$.extend(settings,options),this.each(function(){var selectors=["iframe[src*='player.vimeo.com']","iframe[src*='youtube.com']","iframe[src*='youtube-nocookie.com']","iframe[src*='kickstarter.com'][src*='video.html']","object","embed"];settings.customSelector&&selectors.push(settings.customSelector);var ignoreList=".fitvidsignore";settings.ignore&&(ignoreList=ignoreList+", "+settings.ignore);var $allVideos=$(this).find(selectors.join(","));$allVideos=$allVideos.not("object object"),$allVideos=$allVideos.not(ignoreList),$allVideos.each(function(){var $this=$(this);if(!($this.parents(ignoreList).length>0||"embed"===this.tagName.toLowerCase()&&$this.parent("object").length||$this.parent(".fluid-width-video-wrapper").length)){$this.css("height")||$this.css("width")||!isNaN($this.attr("height"))&&!isNaN($this.attr("width"))||($this.attr("height",9),$this.attr("width",16));var height="object"===this.tagName.toLowerCase()||$this.attr("height")&&!isNaN(parseInt($this.attr("height"),10))?parseInt($this.attr("height"),10):$this.height(),width=isNaN(parseInt($this.attr("width"),10))?$this.width():parseInt($this.attr("width"),10),aspectRatio=height/width;if(!$this.attr("id")){var videoID="fitvid"+Math.floor(999999*Math.random());$this.attr("id",videoID)}$this.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*aspectRatio+"%"),$this.removeAttr("height").removeAttr("width")}})})}}(jQuery)}),define("carousel",["jquery"],function(jQuery){if(void 0===jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var version=$.fn.jquery.split(" ")[0].split(".");if(version[0]<2&&version[1]<9||1==version[0]&&9==version[1]&&version[2]<1||version[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",$.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.3.7",Carousel.TRANSITION_DURATION=600,Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},Carousel.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.getItemForDirection=function(direction,active){var activeIndex=this.getItemIndex(active);if(("prev"==direction&&0===activeIndex||"next"==direction&&activeIndex==this.$items.length-1)&&!this.options.wrap)return active;var delta="prev"==direction?-1:1,itemIndex=(activeIndex+delta)%this.$items.length;return this.$items.eq(itemIndex)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(pos>this.$items.length-1||pos<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",this.$items.eq(pos))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){if(!this.sliding)return this.slide("next")},Carousel.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||this.getItemForDirection(type,$active),isCycling=this.interval,direction="next"==type?"left":"right",that=this;if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd(Carousel.TRANSITION_DURATION)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this};var clickHandler=function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}};$(document).on("click.bs.carousel.data-api","[data-slide]",clickHandler).on("click.bs.carousel.data-api","[data-slide-to]",clickHandler),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery)}),define("functions",["jquery","fitVids","carousel"],function($){function commentsHeight(){var $comments=$(".comments"),parentHeight=$comments.parent().outerHeight();$comments.css("height",parentHeight)}function moreToggle(){$(".more > a").click(function(){return $(".more").toggleClass("expand"),!1})}function homeBoxHeight(){var current=0,max=0;if($(window).width()<800){var $three=$(".three-boxes li:nth-child(3n+1), .three-boxes li:nth-child(3n+2)");$three.each(function(){(current=$(this).outerHeight())>max&&(max=current)}),$three.css("height",max),$(".three-boxes li:nth-child(3n)").css("height","auto")}else{var $li=$(".three-boxes li");$li.each(function(){(current=$(this).outerHeight())>max&&(max=current)}),$li.css("height",max)}}function altVersions(){$(".alt-versions").click(function(){return $(this).parent().siblings(".alt-list").slideToggle(),!1})}function togglePostMore(){var $postTypeMore=$(".post-type-more"),moreHeight=$postTypeMore.height();$postTypeMore.css("height",moreHeight),$(".toggle-more").click(function(){return $(".page-header").hasClass("expanded")?$(".post-type-more").slideUp("fast","linear",function(){var $pageHeader=$(".page-header");$pageHeader.removeClass("expanded"),$pageHeader.removeClass("show-search")}):$(".post-type-more").slideDown("fast","linear",function(){$(".page-header").addClass("expanded")}),!1})}function mobileTogglePostMore(){$(".toggle-more").click(function(){var $moreSpan=$(".toggle-more span");return $moreSpan.hasClass("icon-arrow-up")?($(".post-type-more").slideUp(),$moreSpan.removeClass("icon-arrow-up"),$moreSpan.addClass("icon-arrow-down")):($(".post-type-more").slideDown(),$moreSpan.removeClass("icon-arrow-down"),$moreSpan.addClass("icon-arrow-up")),!1})}function recentHeight(){var currentHeight=0,maxHeight=0,$recent=$(".recent li a");$recent.each(function(){(currentHeight=$(this).outerHeight())>maxHeight&&(maxHeight=currentHeight)}),$recent.css("height",maxHeight)}function featuredHeight(){var cHeight=0,mHeight=0,$featured=$(".featured li a");$featured.each(function(){(cHeight=$(this).outerHeight())>mHeight&&(mHeight=cHeight)}),$featured.css("height",mHeight)}function mentionsHeight(){var cHeight=0,mHeight=0,$news=$(".news-mentions li a");$news.each(function(){(cHeight=$(this).outerHeight())>mHeight&&(mHeight=cHeight)}),$news.css("height",mHeight)}function helpHeights(){var curHeight=0,maxHeight=0,$help=$(".help-section li a");$help.each(function(){(curHeight=$(this).outerHeight())>maxHeight&&(maxHeight=curHeight)}),$help.css("height",maxHeight)}function toggleHubAction(){$("#showHubPosts").click(function(){return $(this).hasClass("active")||($("#showHubDeals").removeClass("active"),$("#showHubPosts").addClass("active"),$("#hubPosts").addClass("visible"),$("#hubDeals").removeClass("visible")),!1}),$("#showHubDeals").click(function(){return $(this).hasClass("active")||($("#showHubPosts").removeClass("active"),$("#showHubDeals").addClass("active"),$("#hubDeals").addClass("visible"),$("#hubPosts").removeClass("visible")),!1})}function homeHeights(){var $posts=$(".home-post-container"),postsH=$posts.outerHeight(),$home=$(".home-sidebar"),dealsH=$home.outerHeight();postsH>dealsH?$home.css("height",postsH):$posts.css("height",dealsH)}function signUpPassword(){$("#signUpPassword").keyup(function(){var password=$(this).val();password.length>7?$("#chars").addClass("green"):$("#chars").removeClass("green"),password.match(/[a-z]/)?$("#oneChar").addClass("green"):$("#oneChar").removeClass("green"),password.match(/\d/)?$("#oneNum").addClass("green"):$("#oneNum").removeClass("green")})}function emptySearchField(){$(".search-form").submit(function(){var $search=$(".search-field");$.trim($search.val())||(event.preventDefault(),$search.addClass("error"),$(".error-label").addClass("show"))})}function showSearch(){$('.subnav-menu li a[title="Search"]').click(function(){var $pageHeader=$(".page-header");return $pageHeader.hasClass("show-search")?$pageHeader.removeClass("show-search"):($pageHeader.addClass("expanded"),$pageHeader.addClass("show-search")),!1})}function offercardHeights(){var curHeight=0,maxHeight=0;$(".offer-cards ul li").each(function(){
(curHeight=$(this).outerHeight())>maxHeight&&(maxHeight=curHeight)}),$(".offer-cards ul li").css("height",maxHeight)}function cityCarousel(){$("#cityCarousel").carousel({interval:!1})}function contentmoduleCarousel(){$("#content_module_carousel").carousel({interval:!1})}function checkForScroll(){if(document.getElementById("blogHeader")){var scrollTarget=document.getElementById("header");scrollTarget&&(scrollTarget.getBoundingClientRect().bottom<0?$(document.body).addClass("scrolled"):$(document.body).removeClass("scrolled"))}}$(document).ready(function(){checkForScroll(),$(window).width()>700?(togglePostMore(),homeHeights()):mobileTogglePostMore(),moreToggle(),altVersions(),helpHeights(),toggleHubAction(),homeBoxHeight(),signUpPassword(),emptySearchField(),showSearch(),cityCarousel(),offercardHeights(),contentmoduleCarousel()}),$(window).load(function(){$(window).width()>700&&commentsHeight(),recentHeight(),featuredHeight(),mentionsHeight()}),$(window).resize(function(){$(window).width();$(".post-type-more").height("auto"),homeBoxHeight()}),$(window).on("scroll",checkForScroll)}),define("app/main",["jquery","date","embed.helper","getAttributes","query.string","identify","deals-widget","default-departure","mlrt","jsrender","functions","price.conversion2","leave-behind","fitVids","fitText"],function($,_date,EmbedHelper,getAttributes,qs,identify,DealsWidget,defaultDeparture,mlrt,jsrender,functions,PriceConversion,LeaveBehind){function querystringStringify(obj){function addParam(key,value){return rv.length>0&&(rv+="&"),rv+='"'+key+'"='+JSON.stringify(value)}function handleKey(key){return addParam(key,obj[key])}var rv="";return Object.keys(obj).forEach(handleKey)}var Page=function(Header,pageData2,SearchBox,reactOpts){this.init(Header,pageData2,SearchBox,reactOpts)};return Page.prototype={init:function(Header,pageData2,SearchBox,reactOpts){if(this.pageData=pageData2,this.siteCode=pageData2.siteCode,this.debug=void 0!==window.console,this.queryParams=toQueryParams(window.location.search.substr(1)),$.views.converters("upper",function(val){return val.toUpperCase()}),$.views.converters("lower",function(val){return val.toLowerCase()}),this.signedIn=!1,"undefined"!=typeof extraScripts)for(var i=0,size=extraScripts.length;i<size;++i)addScriptTag("extra-"+i,extraScripts[i]);this.loadGA(),this.loadGTM(),this.initAds();try{this.currencyReady=this.initReact(Header,SearchBox,reactOpts)}catch(e){console.log(e.stack)}this.checkOptIn(),this.checkForIE(),"function"==typeof mlInit&&mlInit();var $uls=$(".hub-deals ul");if($uls.length){var that=this;$uls.each(function(_,ul){var $ul=$(ul),destinations=that.getDestinationsFromPage($ul),dealsOptions={siteCode:$ul.attr("siteCode"),originCityCode:$ul.attr("originCityCode"),destinationCityCodes:destinations,successCallback:$.proxy(that.onDealsWidgetSuccess,that,$ul),numberOfMarketsToReturn:destinations.length,containerSelector:".flight-deals",linkToProfile:!1},firstDD=$ul.attr("firstdepartdate");Number(firstDD)>0&&(dealsOptions.firstDepartDate=firstDD);var lastDD=$ul.attr("lastdepartdate");Number(lastDD)>0&&(dealsOptions.lastDepartDate=lastDD);var includeCarriers=$ul.attr("includecarriers");includeCarriers&&(dealsOptions.includeCarriers=includeCarriers);var excludeCarriers=$ul.attr("excludecarriers");excludeCarriers&&(dealsOptions.excludeCarriers=excludeCarriers),(new DealsWidget).initiateCalls(dealsOptions)})}var $areaDeals=$(".area-deals"),d1=this.loadDefaultDeparture(),siteCode=$areaDeals.attr("sitecode")||1;$.when(d1,this.currencyReady).done($.proxy(this._getAreaDeals,this,$areaDeals,siteCode)),this.loadLazyImages()},initReact:function(header,SearchBox,reactOpts){var d1=$.Deferred();return SearchBox&&SearchBox.initSearchBox&&SearchBox.initSearchBox(reactOpts),header&&header.initHeader&&(reactOpts.callback=$.proxy(this.hookRedux,this),header.initHeader(reactOpts)),d1},hookRedux:function(store){this.reduxStore=store,this.state=store.getState(),this.metadata=store.getState().metadata,this.unsubscribe=store.subscribe($.proxy(this.reduxStoreChanged,this)),this.metadata.currencies&&(this.pc=new PriceConversion(this.metadata.currency,this.metadata.currencies),this.currencyReady.resolve("Currency Ready"))},reduxStoreChanged:function(){this.state=this.reduxStore.getState();var newMetadata=this.state.metadata;this.buildState(this.state);this.pc?this.metadata.currency!=newMetadata.currency&&(this.metadata.currency=newMetadata.currency,this.pageData.currencyCode=newMetadata.currency,this._currencyChanged(newMetadata.currency)):newMetadata.currencies&&(this.pc=new PriceConversion(newMetadata.currency,newMetadata.currencies),this.currencyReady.resolve("Currency Ready"))},handlePropCategorySelected:function(prop,event){event.preventDefault();var $target=$(event.target);$collapsed=$target.parents(".collapsed"),0!==$collapsed.length||$target.parent().hasClass("selected")||this.loadAreaDeals(prop,$target);var $selector=$target.parents(".select-dropdown");$selector.find("li").length>1&&$selector.toggleClass("collapsed")},requestMoreAreaDeals:function(request,$dealTilesContainer,$newShow,updateTitle){if(this.emptyDealTile&&!updateTitle){$newShow.html("");for(var i=0;i<12;++i)$($newShow).append($(this.emptyDealTile).clone());$($newShow).append('<li class="overlay"><span class="spinner"></span></li>')}var cb=$.proxy(this.handleMoreAreaDeals,this);$.ajax({url:"/flights-services/getAreaDeals.html",type:"GET",dataType:"html",data:request}).done(function(responseText){$($newShow).html($("<div>").append($.parseHTML(responseText)).find(".dealTiles li")),cb(responseText,request,$dealTilesContainer,updateTitle)})},handleMoreAreaDeals:function(data,request,$dealTilesContainer,updateTitle){this.updatePrices($dealTilesContainer),this.resizePricesToFit(),updateTitle&&($h2=$("<div>").append($.parseHTML(data)).find("h2"),$dealTilesContainer.parents(".contentEntry").find("h2").html($h2.html()))},loadAreaDeals:function(prop,$target,updateTitle){var value=$target.attr("value")||$target.parents("[value]").attr("value"),$requestEl=$target.parents("[request]"),json=$requestEl.attr("request");if(json&&json.length>0){var request=JSON.parse(json);request.originCityCode||(request.originCityCode=this.defaultDeparture.code),delete request.areas,request[prop]=value,"maxStops"===prop&&(value>2?request.minStops=0:(request.minStops=value,2===value&&(request.maxStops=4))),$requestEl.attr("request",JSON.stringify(request));var $dealTilesContainer=$requestEl.find(".dealTilesContainer"),$newShow=$dealTilesContainer.find(".dealTiles"+request.areaId);this.requestMoreAreaDeals(request,$dealTilesContainer,$newShow,updateTitle),"areaId"===prop&&($dealTilesContainer.find(".selected").removeClass("selected"),$newShow.addClass("selected"))}$target.parents(".dropdown").find(".selected").removeClass("selected"),$target.parents("li").addClass("selected")},_getAreaDeals:function($areaDeals,siteCode){if($areaDeals.length){var _this=this;$.ajax({url:"/flights-services/getAreaDeals.html",data:{siteCode:siteCode,page:"flyfrom",code:this.defaultDeparture.code,areaId:0,maxAreasToReturn:12,maxDealsPerArea:12,minDealsPerArea:6,departStart:-1,minStops:0,maxStops:4,originCityCode:this.defaultDeparture.code}}).done(function(data){$areaDeals.replaceWith(data),_this.initAreaDealTiles(),_this._currencyChanged(_this.pageData.currencyCode)})}},resizePricesToFit:function(parent){var $priceElements=$(parent||document.body).find(".dealTile .price, .price[data-price]");$priceElements.attr("style","");var recurse=$.proxy(this.resizePricesToFit,this,parent);setTimeout(function(){$priceElements.each(function(){var $this=$(this),parent=$this.parents(".col1");if(parent.length||(parent=$this.parents(".dealTile")),parent.length||(parent=$this.parent()),!$(parent).is(":visible"))return!0;0===parent.length&&(parent=$this.parent());var maxWidth=$(parent).width();if(null===maxWidth)return!0;var textWidth=$this.width();if(0===textWidth)return setTimeout(recurse,100),!1;for(var fontSize=Number($this.css("font-size").replace("px",""));textWidth+1>maxWidth&&fontSize>12;)$this.css("font-size",--fontSize),textWidth=$this.width()})},10)},initAreaDealTiles:function(){var $chooser=$(".areaCategoryChooser");if($chooser.length){$chooser.on("click","a",$.proxy(this.handlePropCategorySelected,this,"areaId"));var fitTiles=$.proxy(this.resizePricesToFit,this);if(setTimeout(fitTiles,100),!this.emptyDealTile){var $tiles=$($chooser.parent().siblings(".dealTilesContainer")),tile=$tiles.find(".deal")[0],emptyDealTile=$(tile).clone();$(emptyDealTile).find("img").removeClass("lazyload").removeAttr("data-src").removeAttr("quoteboxdata"),$(emptyDealTile).find(".dealTile").remove(),this.emptyDealTile=emptyDealTile}}$chooser=$(".departCategoryChooser"),$chooser.length&&$chooser.on("click","a",$.proxy(this.handlePropCategorySelected,this,"departStart")),$chooser=$(".stopsCategoryChooser"),$chooser.length&&$chooser.on("click","a",$.proxy(this.handlePropCategorySelected,this,"maxStops"))},loadLazyImages:function(){try{this.queryParams.debug?addScriptTag("lazysizes","/resources/flights/js/lazysizes.js"):addScriptTag("lazysizes","/resources/flights/js/lazysizes.min.js")}catch(ignore){}},onDefaultDepartureSuccess:function(response){this.defaultDeparture=response.cityLocation,$(".origin").html(this.defaultDeparture.cityLocationName)},loadDefaultDeparture:function(){var d1=$.Deferred(),that=this;return defaultDeparture.initDefaultDeparture({},function(response){that.onDefaultDepartureSuccess(response),d1.resolve("Default departure loaded")},function(){},function(){}),d1},loadGA:function(){window._gaq=window._gaq||[];var account=this.pageData.GA;null!=account&&(_gaq.push(["_setAccount",account]),_gaq.push(["_setDomainName","."+document.domain]),_gaq.push(["_trackPageview",document.location.pathname]),function(){var ga=document.createElement("script");ga.type="text/javascript",ga.async=!0,ga.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(ga)}())},loadGTM:function(){!function(w,d,s,l,i){w[l]=w[l]||[],w[l].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=!0,j.src="//www.googletagmanager.com/gtm.js?id=GTM-NBWJ45",f.parentNode.insertBefore(j,f)}(window,document,"script","dataLayer")},onDealsWidgetSuccess:function($ul,response){if(null!=response.JSON&&"success"==response.JSON){if($ul.length){var noDatesText=$ul.attr("noDatesText")||"",noPriceText=$ul.attr("noPriceText")||"",rowTemplateStr=$ul.attr("rowTemplate"),includeCarriers=$ul.attr("includecarriers"),$template=$.templates(rowTemplateStr),html=[],that=this;$.each(response.destinationCityCodes,function(_,code){if(code!==origin){var deal=response.response.deals[code];deal||(deal={p:noPriceText,dealDates:noDatesText,costText:""});var quoteKey="C"+response.response.originCityCode+"C"+code+(deal.dd||"00000000")+"R"+(deal.rd||"00000000")+"P1CTF",quoteBoxData={origin:response.response.originCityCode,destination:code,departDate:deal.dd,returnDate:deal.rd};deal.dd&&deal.rd&&(deal.dealDates=_calendar_locale.format.singleDate((new Date).fromIDate(deal.dd))+" - "+_calendar_locale.format.singleDate((new Date).fromIDate(deal.rd)),deal.costText=$ul.attr("dealCostText"));var data={quoteKey:quoteKey,quoteBoxData:JSON.stringify(quoteBoxData),destinationCode:code,destinationName:that.getFromCodeMap(response.response.codeMap,code),price:deal.p,usdPrice:deal.u,departDateStr:deal.dd?_calendar_locale.format.singleDate((new Date).fromIDate(deal.dd)):"",returnDateStr:deal.rd?_calendar_locale.format.singleDate((new Date).fromIDate(deal.rd)):"",dealDates:deal.dealDates,dealCostText:deal.costText,dealCtaText:$ul.attr("dealCtaText"),dealCtaStyle:$ul.attr("dealCtaStyle")};includeCarriers&&(data.includeCarriers="%26airlineCode%3D"+includeCarriers),html.push($template.render(data))}}),$ul.html(html.join("")),this.updatePrices()}$("[quoteBoxData]").on("click",$.proxy(this.updateQuoteBox,this))}},getDestinationsFromPage:function($ul){var destinations=[];if($(".hub-deals ul li .hub-deal-code,.top-deals ul li .top-deal-code").each(function(){destinations.push($(this).text())}),0===destinations.length){var destCsv=$ul.attr("destinations");destCsv&&(destinations=destCsv.split(/,/))}return destinations},getFromCodeMap:function(codeMap,key){var value=codeMap[key];return value||key},_handleSessionEvent:function(name,data){},checkOptIn:function(crumb){var cookie=crumb||JSON.parse($.cookie("_fc_optIn")||"{}");window.onCookieStatusChange||(window.onCookieStatusChange=this.onCookieStatusChange.bind(this)),cookie.flow&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"optInComplete"}))},onCookieStatusChange:function(cookie){(cookie||{}).flow&&(this.checkOptIn(cookie),delete window.onCookieStatusChange)},checkForIE:function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE ");(msie>0||navigator.userAgent.match(/Trident.*rv\:11\./))&&(this.ie=parseInt(ua.substring(msie+5,ua.indexOf(".",msie))),$(document).ready(function(){$(".media-list > li:nth-child(odd)").css("background","#f2f2f2"),$(".news-mentions li:nth-child(even)").css("margin-right",0),$(".flexible-fields > div:nth-of-type(even)").css("background","#F2F2F2"),$(".flexible-fields > div:nth-of-type(odd)").css("background","#fff")}))},log:function(val){this.debug&&console.log(val)},quoteBoxReady:function(api){this.addQuoteBoxListeners(),this.embeddedQuoteBox=api;var pageDestination;try{pageDestination=this.getPageDestination(),pageDestination&&this.setQuoteValues(pageDestination)}catch(error){this.log(error)}this._initComponentsDependantOn12q()},setQuoteValues:function(props){props&&(window.console&&console.log(props),this.embeddedQuoteBox.quoteKey&&(props.originCode&&(this.embeddedQuoteBox.quoteKey.origin=props.originCode),props.destinationCode?this.embeddedQuoteBox.quoteKey.destination=props.destinationCode:props.destinationText&&(this.embeddedQuoteBox.destinationText=props.destinationText),props.departureDate&&(this.embeddedQuoteBox.quoteKey.departureDate=props.departureDate),props.returnDate&&(this.embeddedQuoteBox.quoteKey.returnDate=props.returnDate)))},addQuoteBoxListeners:function(){var qb=$("#"+this.quoteBoxId)[0],that=this;["origin.active","destination.active","calendar.active","origin.change","destination.change","departureDate.change","returnDate.change","passengers.change","oneWay.change","category.change","quote.change","quote.submitted","c2.show","c2.hide","c2.open"].forEach(function(item){qb.addEventListener(item,function(n){switch(item){case"quote.submitted":that.showLeaveBehind()}})})},showLeaveBehind:function(){var that=this,quoteKey=window._singletons.quote.quoteKey,destination=window._singletons.destinations.all[quoteKey.destination]||{},origin=window._singletons.destinations.all[quoteKey.origin]||{};if(!destination||!destination.hCity)throw Error("showLeaveBehind: No destination city "+destination);that.lb=new LeaveBehind({language:that.pageData.language,originCityCode:origin.cityCode,destinationCityCode:destination.hCity.cityId,destCity:destination.cityName||destination.name,departureDate:quoteKey.departureDate,returnDate:quoteKey.returnDate,geoLocation:that.defaultDeparture?that.defaultDeparture.code:"",productType:"Hotel",placementType:"FrontdoorDialog",deviceType:"Desktop",resolution:"x01",adults:quoteKey.passengers,siteCode:that.pageData.sitecode,noOfRooms:1,roundTrip:!quoteKey.oneWay,travel:_calendar_locale.format.monthShortDayNumber((new Date).fromIDate(quoteKey.departureDate))+(quoteKey.oneWay?"":" - "+_calendar_locale.format.monthShortDayNumber((new Date).fromIDate(quoteKey.returnDate)))}),that.lb.loadTemplates().done(function(tmpl){that.leaveBehindTemplateName=tmpl;var tmplData={destCity:destination.cityName||destination.name,travel:_calendar_locale.format.monthShortDayNumber((new Date).fromIDate(quoteKey.departureDate))+(quoteKey.oneWay?"":" - "+_calendar_locale.format.monthShortDayNumber((new Date).fromIDate(quoteKey.returnDate))),passengers:quoteKey.passengers,rooms:1,guests:quoteKey.passengers};that.lb.render(tmpl,tmplData);var $lb=$(".leave-behind");if($lb.length){var cb=function(n){that.lb.enable(function(){}),$lb[0].removeEventListener("c2.show",cb)};$lb[0].addEventListener("c2.show",cb)}that.leaveBehind=that.c2Func(".leave-behind",null,{placement:"FrontdoorDialog",secondary:!0,product:"Hotel"}),that.leaveBehind.display()})},filterPropsAlreadySet:function(props,quoteKey){return quoteKey.origin&&delete props.originCode,quoteKey.destination&&delete props.destinationCode,quoteKey.departureDate&&delete props.departureDate,quoteKey.returnDate&&delete props.returnDate,props},_initComponentsDependantOn12q:function(){this.deviceType="unknown";try{this.deviceType=fc.config.isMobile?"m":fc.config.isTablet?"t":"d"}catch(e){}},handleFacebookSignUpClicked:function(event){event.preventDefault();var options={provider:"Facebook"};this.embeddedQuoteBox.signUp(options,function(err,success){alert("err="+err+", success="+success)})},handleSignUpClicked:function(event){event.preventDefault();var params=toQueryParams($(event.target).serialize());if((""+params.email).indexOf("@")<0)return alert("Invalid email"),!1;if(params.password.length>0&&params.password!=params.confirm)return alert("Password and confirm password don't match"),!1;var options={email:params.email,password:params.password};this.embeddedQuoteBox.signUp(options,function(err,success){alert("err="+err+", success="+success)})},getPageDestination:function(){var obj={};if(this.queryParams.hotelcity){var prefix="";isNaN(Number(this.queryParams.hotelcity.substring(0,2)))||(prefix="P"),obj.destinationCode=prefix+this.queryParams.hotelcity}return this.addDefaultSearchDates(obj)},addDefaultSearchDates:function(props){for(var tuesday=new Date;2!=tuesday.getDay();)tuesday.setDate(tuesday.getDate()+1);var departDate=new Date(tuesday.getTime()),returnDate=new Date(tuesday.getTime());return departDate.setDate(departDate.getDate()+21),returnDate.setDate(returnDate.getDate()+28),props||(props={}),props.departureDate=departDate.getIDate(),props.returnDate=returnDate.getIDate(),props},addHeaderListeners:function(){var _this=this,$header=$("#"+this.headerId);$header.length&&$header[0].addEventListener("currency.changed",function(evt){_this._currencyChanged(evt.detail.currencyCode,evt.detail.currencySymbol)})},_currencyChanged:function(code,symbol){this.pageData.currencyCode=code,this.updatePrices(null,code);try{this.resizePricesToFit()}catch(ignore){}},updatePrices:function(el,code){this.pc&&this.pc.updatePrices(code||this.pageData.currencyCode,el)},updateQuoteBox:function(e){var $target=$(e.currentTarget),quoteBoxData=$target.attr("quoteBoxData");if(quoteBoxData){var dict=$.parseJSON(quoteBoxData),quoteProps={};dict.origin&&(quoteProps.originCode="C"+dict.origin),dict.destination&&(quoteProps.destinationCode="C"+dict.destination),dict.departDate&&(quoteProps.depart=dict.departDate+""),dict.returnDate&&(quoteProps.return=dict.returnDate+""),void 0!==this.embeddedQuoteBox&&this.embeddedQuoteBox.setQuoteValues(quoteProps)}},initAds:function(){var $x35=$("#oas_x35");this.registerBanner("x35",$x35.length?[300,250]:null);var $x36=$("#oas_x36");this.registerBanner("x36",$x36.length?[300,600]:null);var registerBanner=$.proxy(this.registerBanner,this);$("[position].oas").each(function(_,$el){registerBanner($el.getAttribute("position"),JSON.parse("["+$el.getAttribute("sizes")+"]"))}),"none"!==$("div.oas").css("display")&&this.displayAd2()},displayAd:function(_ref){var _ref$origin=_ref.origin,_ref$origin$cityCode=_ref$origin.cityCode,O=void 0===_ref$origin$cityCode?"":_ref$origin$cityCode,_ref$origin$countryCo=_ref$origin.countryCode,O_C=void 0===_ref$origin$countryCo?"":_ref$origin$countryCo,_ref$origin$zoneName=_ref$origin.zoneName,O_Z=void 0===_ref$origin$zoneName?"":_ref$origin$zoneName,_ref$origin$cityName=_ref$origin.cityName,_RM_HTML_origin_=void 0===_ref$origin$cityName?"":_ref$origin$cityName,_ref$destination=_ref.destination,_ref$destination$city=_ref$destination.cityCode,D=void 0===_ref$destination$city?"":_ref$destination$city,_ref$destination$coun=_ref$destination.countryCode,D_C=void 0===_ref$destination$coun?"":_ref$destination$coun,_ref$destination$zone=_ref$destination.zoneName,D_Z=void 0===_ref$destination$zone?"":_ref$destination$zone,_ref$destination$city2=_ref$destination.cityName,_RM_HTML_destination_=void 0===_ref$destination$city2?"":_ref$destination$city2,_ref$destination$code=_ref$destination.code,_RM_HTML_hotelCityId_=void 0===_ref$destination$code?"":_ref$destination$code,_ref$departDate=_ref.departDate,_RM_HTML_departDate_=void 0===_ref$departDate?"":_ref$departDate,_ref$returnDate=_ref.returnDate,_RM_HTML_returnDate_=void 0===_ref$returnDate?"":_ref$returnDate,_ref$quoteKey=_ref.quoteKey,_RM_HTML_hotelQuoteKey_=void 0===_ref$quoteKey?"":_ref$quoteKey,_ref$sitePage=_ref.sitePage,sitePage=void 0===_ref$sitePage?"":_ref$sitePage,_RM_HTML_originCode_=O,_RM_HTML_destinationCityCode_=D,load=void 0,positions=Object.keys(banners);0!=positions.length&&(window.oas_tag?load=window.oas_tag.reloadAds:(window.oas_tag=window.oas_tag||{},window.oas_tag.url="oasc05.247realmedia.com",window.oas_tag.sizes=function(){return positions.forEach(function(pos){oas_tag.definePos(pos,banners[pos]),document.getElementById("oas_"+pos).innerHTML=""})},load=this.loadOAS),window.oas_tag.site_page=sitePage,window.oas_tag.query=querystringStringify({O:O,O_C:O_C,O_Z:O_Z,D:D,D_C:D_C,D_Z:D_Z,_RM_HTML_origin_:_RM_HTML_origin_,_RM_HTML_destination_:_RM_HTML_destination_,_RM_HTML_originCode_:_RM_HTML_originCode_,_RM_HTML_destinationCityCode_:_RM_HTML_destinationCityCode_,_RM_HTML_departDate_:_RM_HTML_departDate_,_RM_HTML_returnDate_:_RM_HTML_returnDate_,_RM_HTML_hotelCityId_:_RM_HTML_hotelCityId_,_RM_HTML_hotelQuoteKey_:_RM_HTML_hotelQuoteKey_}),load&&load())},displayAd2:function(){var positions=Object.keys(banners);0!=positions.length&&(window.oas_tag?load=window.oas_tag.reloadAds:(window.oas_tag=window.oas_tag||{},window.oas_tag.url="oasc05.247realmedia.com",window.oas_tag.sizes=function(){return positions.forEach(function(pos){oas_tag.definePos(pos,banners[pos]),document.getElementById("oas_"+pos).innerHTML=""})},load=this.loadOAS),window.oas_tag.site_page="www.farecompare.com/blog",load&&load())},defaultQuoteSelector:function(state){return state&&state.quote||{}},placesCacheSelector:function(state){return state&&state.places||{}},originSelector:function(quote,places){return quote.origin?places[quote.origin]:null},destinationSelector:function(quote,places){return quote.flightDst?places[quote.flightDst]:null},hotelDestinationSelector:function(quote,places){return quote.hotelDst?places[quote.hotelDst]:null},departDateSelector:function(quote){return quote&&quote.departDate},returnDateSelector:function(quote){return quote&&quote.returnDate},unpack:function(){var _ref2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},code=_ref2.code,altCountryCode=_ref2.countryCode,altZoneName=_ref2.zoneName,_ref=arguments[1],cityCode=_ref.cityCode,countryCode=_ref.countryCode,zoneName=_ref.zoneName,cityName=_ref.cityName,name=_ref.name;return _ref.destType&&{code:code,cityCode:cityCode,countryCode:countryCode||altCountryCode,zoneName:zoneName||altZoneName,cityName:cityName||name}},unpackPlace:function(place){return place&&this.unpack(place.hCity,place)},unpackOrigin:function(quote,places){return this.unpackPlace(this.originSelector(quote,places))},unpackDestination:function(quote,places){return this.unpackPlace(this.hotelDestinationSelector(quote,places))},buildState:function(state){var quote=this.defaultQuoteSelector(state),places=this.placesCacheSelector(state);return{origin:this.unpackOrigin(quote,places),destination:this.unpackDestination(quote,places),departDate:this.departDateSelector(quote),returnDate:this.returnDateSelector(quote)}},registerBanner:function(pos,el){el?banners[pos]=el:delete banners[pos]},loadOAS:function(){var oas_tag=window.oas_tag,oas=document.createElement("script"),node=document.getElementsByTagName("script")[0];oas_tag.version="1",oas_tag.loadAd=oas_tag.loadAd||function(){},oas.type="text/javascript",oas.async=!0,oas.src="https://"+oas_tag.url+"/om/"+oas_tag.version+".js",node.parentNode.insertBefore(oas,node)}},banners={},Page});
//# sourceMappingURL=blogs-v1.2.12.js.map